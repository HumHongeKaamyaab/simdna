<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>synthetic &mdash; SimDNA 0.0.1 documentation</title>
    
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="SimDNA 0.0.1 documentation" href="../index.html" />
    <link rel="up" title="Module code" href="index.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for synthetic</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">division</span><span class="p">;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">sys</span><span class="p">;</span>
<span class="n">scriptsDir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;UTIL_SCRIPTS_DIR&quot;</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">scriptsDir</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Please set environment variable UTIL_SCRIPTS_DIR&quot;</span><span class="p">);</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">scriptsDir</span><span class="p">);</span>
<span class="kn">import</span> <span class="nn">pathSetter</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">util</span><span class="p">;</span>
<span class="kn">from</span> <span class="nn">pwm</span> <span class="k">import</span> <span class="n">pwm</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">random</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">fileProcessing</span> <span class="k">as</span> <span class="nn">fp</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">math</span><span class="p">;</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">OrderedDict</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">json</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">re</span><span class="p">;</span>

<div class="viewcode-block" id="LabelGenerator"><a class="viewcode-back" href="../synthetic.html#synthetic.LabelGenerator">[docs]</a><span class="k">class</span> <span class="nc">LabelGenerator</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">labelNames</span><span class="p">,</span> <span class="n">labelsFromGeneratedSequenceFunction</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            labelNames: an array of strings</span>
<span class="sd">            labelsFromGeneratedSequenceFunction: function that accepts</span>
<span class="sd">                an instance of generatedSequence and returns an array</span>
<span class="sd">                of the labels</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">labelNames</span><span class="o">=</span><span class="n">labelNames</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">labelsFromGeneratedSequenceFunction</span><span class="o">=</span><span class="n">labelsFromGeneratedSequenceFunction</span><span class="p">;</span>
<div class="viewcode-block" id="LabelGenerator.generateLabels"><a class="viewcode-back" href="../synthetic.html#synthetic.LabelGenerator.generateLabels">[docs]</a>    <span class="k">def</span> <span class="nf">generateLabels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">generatedSequence</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">labelsFromGeneratedSequenceFunction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">generatedSequence</span><span class="p">);</span></div></div>

<div class="viewcode-block" id="IsInTraceLabelGenerator"><a class="viewcode-back" href="../synthetic.html#synthetic.IsInTraceLabelGenerator">[docs]</a><span class="k">class</span> <span class="nc">IsInTraceLabelGenerator</span><span class="p">(</span><span class="n">LabelGenerator</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">labelNames</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">labelsFromGeneratedSequenceFunction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">generatedSequence</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">[(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">generatedSequence</span><span class="o">.</span><span class="n">additionalInfo</span><span class="o">.</span><span class="n">isInTrace</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labelNames</span><span class="p">];</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">IsInTraceLabelGenerator</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">labelNames</span><span class="p">,</span> <span class="n">labelsFromGeneratedSequenceFunction</span><span class="p">);</span></div>

<div class="viewcode-block" id="printSequences"><a class="viewcode-back" href="../synthetic.html#synthetic.printSequences">[docs]</a><span class="k">def</span> <span class="nf">printSequences</span><span class="p">(</span><span class="n">outputFileName</span><span class="p">,</span> <span class="n">sequenceSetGenerator</span><span class="p">,</span> <span class="n">includeEmbeddings</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">labelGenerator</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">includeFasta</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        outputFileName: string</span>
<span class="sd">        sequenceSetGenerator: instance of AbstractSequenceSetGenerator</span>
<span class="sd">        Given an output filename, and an instance of AbstractSequenceSetGenerator,</span>
<span class="sd">        will call the sequence set generator and print the generated sequences</span>
<span class="sd">        to the output file. Will also create a file &quot;info_outputFileName.txt&quot;</span>
<span class="sd">        in the samedirectory as outputFileName that contains all the information</span>
<span class="sd">        about sequenceSetGenerator.</span>
<span class="sd">        includeEmbeddings: a boolean indicating whether to print a column that lists the embeddings</span>
<span class="sd">        labelGenerator: instance of LabelGenerator</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ofh</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">getFileHandle</span><span class="p">(</span><span class="n">outputFileName</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">includeFasta</span><span class="p">):</span>
        <span class="n">fastaOfh</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">getFileHandle</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">getFileNameParts</span><span class="p">(</span><span class="n">outputFileName</span><span class="p">)</span><span class="o">.</span><span class="n">getFilePathWithTransformation</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="n">extension</span><span class="o">=</span><span class="s2">&quot;.fa&quot;</span><span class="p">),</span> <span class="s1">&#39;w&#39;</span><span class="p">);</span>
    <span class="n">ofh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;seqName</span><span class="se">\t</span><span class="s2">sequence&quot;</span><span class="o">+</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">embeddings&quot;</span> <span class="k">if</span> <span class="n">includeEmbeddings</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="o">+</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">labelGenerator</span><span class="o">.</span><span class="n">labelNames</span><span class="p">)</span> <span class="k">if</span> <span class="n">labelGenerator</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="n">generatedSequences</span> <span class="o">=</span> <span class="n">sequenceSetGenerator</span><span class="o">.</span><span class="n">generateSequences</span><span class="p">();</span> <span class="c1">#returns a generator</span>
    <span class="k">for</span> <span class="n">generatedSequence</span> <span class="ow">in</span> <span class="n">generatedSequences</span><span class="p">:</span>
        <span class="n">ofh</span><span class="o">.</span><span class="n">write</span><span class="p">((</span><span class="n">prefix</span><span class="o">+</span><span class="s2">&quot;-&quot;</span> <span class="k">if</span> <span class="n">prefix</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">+</span><span class="n">generatedSequence</span><span class="o">.</span><span class="n">seqName</span><span class="o">+</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="o">+</span><span class="n">generatedSequence</span><span class="o">.</span><span class="n">seq</span>
                    <span class="o">+</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="o">+</span><span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">generatedSequence</span><span class="o">.</span><span class="n">embeddings</span><span class="p">)</span> <span class="k">if</span> <span class="n">includeEmbeddings</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                    <span class="o">+</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="o">+</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">labelGenerator</span><span class="o">.</span><span class="n">generateLabels</span><span class="p">(</span><span class="n">generatedSequence</span><span class="p">))</span> <span class="k">if</span> <span class="n">labelGenerator</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                    <span class="o">+</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">includeFasta</span><span class="p">):</span>
            <span class="n">fastaOfh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&gt;&quot;</span><span class="o">+</span><span class="p">(</span><span class="n">prefix</span><span class="o">+</span><span class="s2">&quot;-&quot;</span> <span class="k">if</span> <span class="n">prefix</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">+</span><span class="n">generatedSequence</span><span class="o">.</span><span class="n">seqName</span><span class="o">+</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span> 
            <span class="n">fastaOfh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">generatedSequence</span><span class="o">.</span><span class="n">seq</span><span class="o">+</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
        
    <span class="n">ofh</span><span class="o">.</span><span class="n">close</span><span class="p">();</span> 
    <span class="k">if</span> <span class="p">(</span><span class="n">includeFasta</span><span class="p">):</span>
        <span class="n">fastaOfh</span><span class="o">.</span><span class="n">close</span><span class="p">();</span>
    <span class="n">infoFilePath</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">getFileNameParts</span><span class="p">(</span><span class="n">outputFileName</span><span class="p">)</span><span class="o">.</span><span class="n">getFilePathWithTransformation</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">+</span><span class="s2">&quot;_info&quot;</span><span class="p">,</span> <span class="n">extension</span><span class="o">=</span><span class="s2">&quot;.txt&quot;</span><span class="p">);</span>
    
    <span class="n">ofh</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">getFileHandle</span><span class="p">(</span><span class="n">infoFilePath</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">);</span>
    <span class="n">ofh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">util</span><span class="o">.</span><span class="n">formattedJsonDump</span><span class="p">(</span><span class="n">sequenceSetGenerator</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">()));</span> 
    <span class="n">ofh</span><span class="o">.</span><span class="n">close</span><span class="p">();</span></div>

<div class="viewcode-block" id="printSequencesTransformationPosNeg"><a class="viewcode-back" href="../synthetic.html#synthetic.printSequencesTransformationPosNeg">[docs]</a><span class="k">def</span> <span class="nf">printSequencesTransformationPosNeg</span><span class="p">(</span><span class="n">outputFileNamePos</span><span class="p">,</span> <span class="n">outputFileNameNeg</span><span class="p">,</span> <span class="n">sequenceSetGenerator</span><span class="p">,</span> <span class="n">transformation</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        outputFileName: string</span>
<span class="sd">        sequenceSetGenerator: instance of AbstractSequenceSetGenerator</span>
<span class="sd">		generatedSequences: the sequences that have been generated by sequenceSetGenerator</span>
<span class="sd">        Given an output filename, and an instance of AbstractSequenceSetGenerator,</span>
<span class="sd">        will print the generated sequences to the output file. Will also create a file </span>
<span class="sd">		&quot;info_outputFileName.txt&quot; in the same directory as outputFileName that contains all the </span>
<span class="sd">		information about sequenceSetGenerator.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ofhPos</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">getFileHandle</span><span class="p">(</span><span class="n">outputFileNamePos</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">);</span>
    <span class="n">ofhPos</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;seqName</span><span class="se">\t</span><span class="s2">sequence</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="n">ofhNeg</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">getFileHandle</span><span class="p">(</span><span class="n">outputFileNameNeg</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">);</span>
    <span class="n">ofhNeg</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;seqName</span><span class="se">\t</span><span class="s2">sequence</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="n">generatedSequences</span> <span class="o">=</span> <span class="n">sequenceSetGenerator</span><span class="o">.</span><span class="n">generateSequences</span><span class="p">();</span> <span class="c1">#returns a generator</span>
	
    <span class="k">for</span> <span class="n">generateSequence</span> <span class="ow">in</span> <span class="n">generatedSequences</span><span class="p">:</span>
		<span class="c1"># Iterate through the generated sequences, recording them in the pos. file, make a 1 bp substitution in the motif, and record the changed sequence in the neg. file</span>
        <span class="n">ofhPos</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">generateSequence</span><span class="o">.</span><span class="n">seqName</span><span class="o">+</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="o">+</span><span class="n">generateSequence</span><span class="o">.</span><span class="n">seq</span><span class="o">+</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
		
        <span class="n">embedding</span> <span class="o">=</span> <span class="n">generateSequence</span><span class="o">.</span><span class="n">embeddings</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">embeddingList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">embedding</span><span class="o">.</span><span class="n">what</span><span class="p">)</span>
        <span class="n">transformation</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">embeddingList</span><span class="p">)</span>
        <span class="n">embeddingNeg</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">embeddingList</span><span class="p">)</span>
        <span class="n">seqNeg</span> <span class="o">=</span> <span class="n">generateSequence</span><span class="o">.</span><span class="n">seq</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">embedding</span><span class="o">.</span><span class="n">startPos</span><span class="p">]</span> <span class="o">+</span> <span class="n">embeddingNeg</span> <span class="o">+</span> <span class="n">generateSequence</span><span class="o">.</span><span class="n">seq</span><span class="p">[</span><span class="n">embedding</span><span class="o">.</span><span class="n">startPos</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">embeddingNeg</span><span class="p">):</span><span class="nb">len</span><span class="p">(</span><span class="n">generateSequence</span><span class="o">.</span><span class="n">seq</span><span class="p">)]</span>
        <span class="n">generateSequenceNeg</span> <span class="o">=</span> <span class="n">generateSequence</span>
        <span class="n">generateSequenceNeg</span><span class="o">.</span><span class="n">seq</span> <span class="o">=</span> <span class="n">seqNeg</span>
        <span class="n">ofhNeg</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">generateSequenceNeg</span><span class="o">.</span><span class="n">seqName</span><span class="o">+</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="o">+</span><span class="n">generateSequenceNeg</span><span class="o">.</span><span class="n">seq</span><span class="o">+</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
		
    <span class="n">ofhPos</span><span class="o">.</span><span class="n">close</span><span class="p">();</span> 
    <span class="n">ofhNeg</span><span class="o">.</span><span class="n">close</span><span class="p">();</span> 
    <span class="n">infoFilePathPos</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">getFileNameParts</span><span class="p">(</span><span class="n">outputFileNamePos</span><span class="p">)</span><span class="o">.</span><span class="n">getFilePathWithTransformation</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">&quot;info_&quot;</span><span class="o">+</span><span class="n">x</span><span class="p">,</span> <span class="n">extension</span><span class="o">=</span><span class="s2">&quot;.txt&quot;</span><span class="p">);</span>
    
    <span class="kn">import</span> <span class="nn">json</span><span class="p">;</span>
    <span class="n">ofhPos</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">getFileHandle</span><span class="p">(</span><span class="n">infoFilePathPos</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">);</span>
    <span class="n">ofhPos</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">sequenceSetGenerator</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">(),</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">separators</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;: &#39;</span><span class="p">)));</span> 
    <span class="n">ofhPos</span><span class="o">.</span><span class="n">close</span><span class="p">();</span></div>

<div class="viewcode-block" id="DefaultNameMixin"><a class="viewcode-back" href="../synthetic.html#synthetic.DefaultNameMixin">[docs]</a><span class="k">class</span> <span class="nc">DefaultNameMixin</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">name</span><span class="o">==</span><span class="kc">None</span><span class="p">):</span>
            <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">getDefaultName</span><span class="p">();</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">;</span>
<div class="viewcode-block" id="DefaultNameMixin.getDefaultName"><a class="viewcode-back" href="../synthetic.html#synthetic.DefaultNameMixin.getDefaultName">[docs]</a>    <span class="k">def</span> <span class="nf">getDefaultName</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">());</span></div></div>

<div class="viewcode-block" id="AbstractPositionGenerator"><a class="viewcode-back" href="../synthetic.html#synthetic.AbstractPositionGenerator">[docs]</a><span class="k">class</span> <span class="nc">AbstractPositionGenerator</span><span class="p">(</span><span class="n">DefaultNameMixin</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Given the length of the background sequence and the length</span>
<span class="sd">        of the substring you are trying to embed, will return a start position</span>
<span class="sd">        to embed the substring at.</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="AbstractPositionGenerator.generatePos"><a class="viewcode-back" href="../synthetic.html#synthetic.AbstractPositionGenerator.generatePos">[docs]</a>    <span class="k">def</span> <span class="nf">generatePos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lenBackground</span><span class="p">,</span> <span class="n">lenSubstring</span><span class="p">,</span> <span class="n">additionalInfo</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">additionalInfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
            <span class="n">additionalInfo</span><span class="o">.</span><span class="n">updateTrace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">);</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generatePos</span><span class="p">(</span><span class="n">lenBackground</span><span class="p">,</span> <span class="n">lenSubstring</span><span class="p">,</span> <span class="n">additionalInfo</span><span class="p">);</span></div>
    <span class="k">def</span> <span class="nf">_generatePos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lenBackground</span><span class="p">,</span> <span class="n">lenSubstring</span><span class="p">,</span> <span class="n">additionalInfo</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">();</span>
<div class="viewcode-block" id="AbstractPositionGenerator.getJsonableObject"><a class="viewcode-back" href="../synthetic.html#synthetic.AbstractPositionGenerator.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">();</span></div></div>

<div class="viewcode-block" id="UniformPositionGenerator"><a class="viewcode-back" href="../synthetic.html#synthetic.UniformPositionGenerator">[docs]</a><span class="k">class</span> <span class="nc">UniformPositionGenerator</span><span class="p">(</span><span class="n">AbstractPositionGenerator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        samples a start position to embed the substring in uniformly at random;</span>
<span class="sd">        does not return positions that are too close to the end of the</span>
<span class="sd">        background sequence to embed the full substring.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">UniformPositionGenerator</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
    <span class="k">def</span> <span class="nf">_generatePos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lenBackground</span><span class="p">,</span> <span class="n">lenSubstring</span><span class="p">,</span> <span class="n">additionalInfo</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">sampleIndexWithinRegionOfLength</span><span class="p">(</span><span class="n">lenBackground</span><span class="p">,</span> <span class="n">lenSubstring</span><span class="p">);</span> 
<div class="viewcode-block" id="UniformPositionGenerator.getJsonableObject"><a class="viewcode-back" href="../synthetic.html#synthetic.UniformPositionGenerator.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;uniform&quot;</span><span class="p">;</span></div></div>
<span class="n">uniformPositionGenerator</span> <span class="o">=</span> <span class="n">UniformPositionGenerator</span><span class="p">();</span>

<div class="viewcode-block" id="InsideCentralBp"><a class="viewcode-back" href="../synthetic.html#synthetic.InsideCentralBp">[docs]</a><span class="k">class</span> <span class="nc">InsideCentralBp</span><span class="p">(</span><span class="n">AbstractPositionGenerator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        returns a position within the central region of a background</span>
<span class="sd">        sequence, sampled uniformly at random</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">centralBp</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            centralBp: the number of bp, centered in the middle of the background,</span>
<span class="sd">            from which to sample the position. Is NOT +/- centralBp around the</span>
<span class="sd">            middle (is +/- centralBp/2 around the middle).</span>
<span class="sd">            If the background sequence is even and centralBp is odd, the shorter</span>
<span class="sd">            region will go on the left.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">centralBp</span> <span class="o">=</span> <span class="n">centralBp</span><span class="p">;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">InsideCentralBp</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
    <span class="k">def</span> <span class="nf">_generatePos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lenBackground</span><span class="p">,</span> <span class="n">lenSubstring</span><span class="p">,</span> <span class="n">additionalInfo</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">lenBackground</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">centralBp</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;The background length should be atleast as long as self.centralBp; is &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">lenBackground</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot; and &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">centralBp</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot; respectively&quot;</span><span class="p">);</span>
        <span class="n">startIndexForRegionToEmbedIn</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lenBackground</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">centralBp</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span>
        <span class="n">indexToSample</span> <span class="o">=</span> <span class="n">startIndexForRegionToEmbedIn</span> <span class="o">+</span> <span class="n">sampleIndexWithinRegionOfLength</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">centralBp</span><span class="p">,</span> <span class="n">lenSubstring</span><span class="p">);</span> 
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">indexToSample</span><span class="p">);</span>
<div class="viewcode-block" id="InsideCentralBp.getJsonableObject"><a class="viewcode-back" href="../synthetic.html#synthetic.InsideCentralBp.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;insideCentral-&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">centralBp</span><span class="p">);</span></div></div>

<div class="viewcode-block" id="OutsideCentralBp"><a class="viewcode-back" href="../synthetic.html#synthetic.OutsideCentralBp">[docs]</a><span class="k">class</span> <span class="nc">OutsideCentralBp</span><span class="p">(</span><span class="n">AbstractPositionGenerator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a position OUTSIDE the central region of a background sequence,</span>
<span class="sd">        sampled uniformly at random. Complement of InsideCentralBp.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">centralBp</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">centralBp</span> <span class="o">=</span> <span class="n">centralBp</span><span class="p">;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">OutsideCentralBp</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
    <span class="k">def</span> <span class="nf">_generatePos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lenBackground</span><span class="p">,</span> <span class="n">lenSubstring</span><span class="p">,</span> <span class="n">additionalInfo</span><span class="p">):</span>
        <span class="c1">#choose whether to embed in the left or the right</span>
        <span class="k">if</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">:</span>
            <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">left</span><span class="o">=</span><span class="kc">False</span><span class="p">;</span>
        <span class="c1">#embeddableLength is the length of the region we are considering embedding in</span>
        <span class="n">embeddableLength</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">lenBackground</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">centralBp</span><span class="p">);</span>
        <span class="c1">#if lenBackground-self.centralBp is odd, the longer region</span>
        <span class="c1">#goes on the left (inverse of the shorter embeddable region going on the left in</span>
        <span class="c1">#the centralBpToEmbedIn case</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">left</span><span class="p">):</span>
            <span class="n">embeddableLength</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">embeddableLength</span><span class="p">);</span>
            <span class="n">startIndexForRegionToEmbedIn</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">embeddableLength</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">embeddableLength</span><span class="p">);</span>
            <span class="n">startIndexForRegionToEmbedIn</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">((</span><span class="n">lenBackground</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">centralBp</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">centralBp</span><span class="p">;</span>
        <span class="n">indexToSample</span> <span class="o">=</span> <span class="n">startIndexForRegionToEmbedIn</span><span class="o">+</span><span class="n">sampleIndexWithinRegionOfLength</span><span class="p">(</span><span class="n">embeddableLength</span><span class="p">,</span> <span class="n">lenSubstring</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">indexToSample</span><span class="p">);</span>
<div class="viewcode-block" id="OutsideCentralBp.getJsonableObject"><a class="viewcode-back" href="../synthetic.html#synthetic.OutsideCentralBp.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;outsideCentral-&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">centralBp</span><span class="p">);</span></div></div>

<div class="viewcode-block" id="GeneratedSequence"><a class="viewcode-back" href="../synthetic.html#synthetic.GeneratedSequence">[docs]</a><span class="k">class</span> <span class="nc">GeneratedSequence</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        An object representing a sequence that has been</span>
<span class="sd">        generated.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seqName</span><span class="p">,</span> <span class="n">seq</span><span class="p">,</span> <span class="n">embeddings</span><span class="p">,</span> <span class="n">additionalInfo</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            seqName: string</span>
<span class="sd">            seq: generated sequence (string)</span>
<span class="sd">            embeddings: array of Embedding objects</span>
<span class="sd">            additionalInfo: instance of AdditionalInfo</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seqName</span> <span class="o">=</span> <span class="n">seqName</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seq</span> <span class="o">=</span> <span class="n">seq</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">embeddings</span> <span class="o">=</span> <span class="n">embeddings</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">additionalInfo</span> <span class="o">=</span> <span class="n">additionalInfo</span><span class="p">;</span></div>

<div class="viewcode-block" id="Embedding"><a class="viewcode-back" href="../synthetic.html#synthetic.Embedding">[docs]</a><span class="k">class</span> <span class="nc">Embedding</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Represents something that has been embedded in</span>
<span class="sd">        a sequence</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">what</span><span class="p">,</span> <span class="n">startPos</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            what: object representing the thing that has been embedded. Should have __str__ and __len__ defined</span>
<span class="sd">            startPos: that position relative to the start of the</span>
<span class="sd">            parent sequence at which seq has been embedded</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">what</span> <span class="o">=</span> <span class="n">what</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">startPos</span> <span class="o">=</span> <span class="n">startPos</span><span class="p">;</span>
    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;pos-&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">startPos</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">what</span><span class="p">);</span>
    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="Embedding.fromString"><a class="viewcode-back" href="../synthetic.html#synthetic.Embedding.fromString">[docs]</a>    <span class="k">def</span> <span class="nf">fromString</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">string</span><span class="p">,</span> <span class="n">whatClass</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">whatClass</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
            <span class="n">whatClass</span><span class="o">=</span><span class="n">StringEmbeddable</span><span class="p">;</span>
        <span class="c1">#was printed out as pos-[startPos]_[what], but the</span>
        <span class="c1">#[what] may contain underscores, hence the maxsplit</span>
        <span class="c1">#to avoid splitting on them.</span>
        <span class="n">prefix</span><span class="p">,</span><span class="n">startPos</span><span class="p">,</span><span class="n">whatString</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-|_&quot;</span><span class="p">,</span><span class="n">string</span><span class="p">,</span><span class="n">maxsplit</span><span class="o">=</span><span class="mi">2</span><span class="p">);</span> 
        <span class="k">return</span> <span class="n">cls</span><span class="p">(</span><span class="n">what</span><span class="o">=</span><span class="n">whatClass</span><span class="o">.</span><span class="n">fromString</span><span class="p">(</span><span class="n">whatString</span><span class="p">),</span> <span class="n">startPos</span><span class="o">=</span><span class="n">startPos</span><span class="p">);</span> </div></div>

<div class="viewcode-block" id="getEmbeddingsFromString"><a class="viewcode-back" href="../synthetic.html#synthetic.getEmbeddingsFromString">[docs]</a><span class="k">def</span> <span class="nf">getEmbeddingsFromString</span><span class="p">(</span><span class="n">string</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">string</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">embeddingStrings</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">);</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">Embedding</span><span class="o">.</span><span class="n">fromString</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">embeddingStrings</span><span class="p">];</span></div>

<div class="viewcode-block" id="AbstractSequenceSetGenerator"><a class="viewcode-back" href="../synthetic.html#synthetic.AbstractSequenceSetGenerator">[docs]</a><span class="k">class</span> <span class="nc">AbstractSequenceSetGenerator</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        class that is used to return a generator for a collection</span>
<span class="sd">        of generated sequences.</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="AbstractSequenceSetGenerator.generateSequences"><a class="viewcode-back" href="../synthetic.html#synthetic.AbstractSequenceSetGenerator.generateSequences">[docs]</a>    <span class="k">def</span> <span class="nf">generateSequences</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            returns a generator of GeneratedSequence objects</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">();</span></div>
<div class="viewcode-block" id="AbstractSequenceSetGenerator.getJsonableObject"><a class="viewcode-back" href="../synthetic.html#synthetic.AbstractSequenceSetGenerator.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            returns an object representing the details of this, which</span>
<span class="sd">            can be converted to json.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">();</span></div></div>

<div class="viewcode-block" id="GenerateSequenceNTimes"><a class="viewcode-back" href="../synthetic.html#synthetic.GenerateSequenceNTimes">[docs]</a><span class="k">class</span> <span class="nc">GenerateSequenceNTimes</span><span class="p">(</span><span class="n">AbstractSequenceSetGenerator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        If you just want to use a generator of a single sequence and</span>
<span class="sd">        call it N times, use this class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">singleSetGenerator</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            singleSetGenerator: an instance of AbstractSequenceSetGenerator</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">singleSetGenerator</span> <span class="o">=</span> <span class="n">singleSetGenerator</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">N</span> <span class="o">=</span> <span class="n">N</span><span class="p">;</span>
<div class="viewcode-block" id="GenerateSequenceNTimes.generateSequences"><a class="viewcode-back" href="../synthetic.html#synthetic.GenerateSequenceNTimes.generateSequences">[docs]</a>    <span class="k">def</span> <span class="nf">generateSequences</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            calls singleSetGenerator N times.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">):</span>
            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">singleSetGenerator</span><span class="o">.</span><span class="n">generateSequence</span><span class="p">();</span></div>
<div class="viewcode-block" id="GenerateSequenceNTimes.getJsonableObject"><a class="viewcode-back" href="../synthetic.html#synthetic.GenerateSequenceNTimes.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="s2">&quot;numSeq&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">),(</span><span class="s2">&quot;singleSetGenerator&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">singleSetGenerator</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">())]);</span></div></div>

<div class="viewcode-block" id="AbstractSingleSequenceGenerator"><a class="viewcode-back" href="../synthetic.html#synthetic.AbstractSingleSequenceGenerator">[docs]</a><span class="k">class</span> <span class="nc">AbstractSingleSequenceGenerator</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        When called, generates a single sequence</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">namePrefix</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            namePrefix: the GeneratedSequence object has a field for the object&#39;s name; this is</span>
<span class="sd">            the prefix associated with that name. The suffix is the value of a counter that</span>
<span class="sd">            is incremented every time </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">namePrefix</span> <span class="o">=</span> <span class="n">namePrefix</span> <span class="k">if</span> <span class="n">namePrefix</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;synth&quot;</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sequenceCounter</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<div class="viewcode-block" id="AbstractSingleSequenceGenerator.generateSequence"><a class="viewcode-back" href="../synthetic.html#synthetic.AbstractSingleSequenceGenerator.generateSequence">[docs]</a>    <span class="k">def</span> <span class="nf">generateSequence</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            returns GeneratedSequence object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">();</span> </div>
<div class="viewcode-block" id="AbstractSingleSequenceGenerator.getJsonableObject"><a class="viewcode-back" href="../synthetic.html#synthetic.AbstractSingleSequenceGenerator.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            returns an object representing the details of this, which</span>
<span class="sd">            can be converted to json.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">();</span></div></div>

<div class="viewcode-block" id="AdditionalInfo"><a class="viewcode-back" href="../synthetic.html#synthetic.AdditionalInfo">[docs]</a><span class="k">class</span> <span class="nc">AdditionalInfo</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trace</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">();</span> <span class="c1">#a trace of everything that was called.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">additionalInfo</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">();</span> <span class="c1"># for more ad-hoc messages</span>
<div class="viewcode-block" id="AdditionalInfo.isInTrace"><a class="viewcode-back" href="../synthetic.html#synthetic.AdditionalInfo.isInTrace">[docs]</a>    <span class="k">def</span> <span class="nf">isInTrace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operatorName</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">operatorName</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">trace</span><span class="p">;</span></div>
<div class="viewcode-block" id="AdditionalInfo.updateTrace"><a class="viewcode-back" href="../synthetic.html#synthetic.AdditionalInfo.updateTrace">[docs]</a>    <span class="k">def</span> <span class="nf">updateTrace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operatorName</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">operatorName</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">trace</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">trace</span><span class="p">[</span><span class="n">operatorName</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trace</span><span class="p">[</span><span class="n">operatorName</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span></div>
<div class="viewcode-block" id="AdditionalInfo.updateAdditionalInfo"><a class="viewcode-back" href="../synthetic.html#synthetic.AdditionalInfo.updateAdditionalInfo">[docs]</a>    <span class="k">def</span> <span class="nf">updateAdditionalInfo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operatorName</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">additionaInfo</span><span class="p">[</span><span class="n">operatorName</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span></div></div>

<div class="viewcode-block" id="EmbedInABackground"><a class="viewcode-back" href="../synthetic.html#synthetic.EmbedInABackground">[docs]</a><span class="k">class</span> <span class="nc">EmbedInABackground</span><span class="p">(</span><span class="n">AbstractSingleSequenceGenerator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Takes a backgroundGenerator and a series of embedders. Will</span>
<span class="sd">        generate the background and then call each of the embedders in</span>
<span class="sd">        succession. Then returns the result.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">backgroundGenerator</span><span class="p">,</span> <span class="n">embedders</span><span class="p">,</span> <span class="n">namePrefix</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            backgroundGenerator: instance of AbstractBackgroundGenerator</span>
<span class="sd">            embedders: array of instances of AbstractEmbedder</span>
<span class="sd">            namePrefix: see parent</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">EmbedInABackground</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">namePrefix</span><span class="p">);</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">backgroundGenerator</span> <span class="o">=</span> <span class="n">backgroundGenerator</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">embedders</span> <span class="o">=</span> <span class="n">embedders</span><span class="p">;</span>
<div class="viewcode-block" id="EmbedInABackground.generateSequence"><a class="viewcode-back" href="../synthetic.html#synthetic.EmbedInABackground.generateSequence">[docs]</a>    <span class="k">def</span> <span class="nf">generateSequence</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            generates a background using self.backgroundGenerator, splits it into an array,</span>
<span class="sd">            and passes it to each of self.embedders in turn for embedding things.</span>
<span class="sd">            returns an instance of GeneratedSequence</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">additionalInfo</span> <span class="o">=</span> <span class="n">AdditionalInfo</span><span class="p">();</span>
        <span class="n">backgroundString</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">backgroundGenerator</span><span class="o">.</span><span class="n">generateBackground</span><span class="p">();</span>
        <span class="n">backgroundStringArr</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">backgroundString</span><span class="p">];</span>
        <span class="c1">#priorEmbeddedThings keeps track of what has already been embedded</span>
        <span class="n">priorEmbeddedThings</span> <span class="o">=</span> <span class="n">PriorEmbeddedThings_numpyArrayBacked</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">backgroundStringArr</span><span class="p">));</span>
        <span class="k">for</span> <span class="n">embedder</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">embedders</span><span class="p">:</span>
            <span class="n">embedder</span><span class="o">.</span><span class="n">embed</span><span class="p">(</span><span class="n">backgroundStringArr</span><span class="p">,</span> <span class="n">priorEmbeddedThings</span><span class="p">,</span> <span class="n">additionalInfo</span><span class="p">);</span>  
        <span class="bp">self</span><span class="o">.</span><span class="n">sequenceCounter</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">GeneratedSequence</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">namePrefix</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sequenceCounter</span><span class="p">),</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">backgroundStringArr</span><span class="p">),</span> <span class="n">priorEmbeddedThings</span><span class="o">.</span><span class="n">getEmbeddings</span><span class="p">(),</span> <span class="n">additionalInfo</span><span class="p">);</span></div>
<div class="viewcode-block" id="EmbedInABackground.getJsonableObject"><a class="viewcode-back" href="../synthetic.html#synthetic.EmbedInABackground.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            see parent</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="s2">&quot;class&quot;</span><span class="p">,</span> <span class="s2">&quot;EmbedInABackground&quot;</span><span class="p">)</span>
                            <span class="p">,(</span><span class="s2">&quot;namePrefix&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">namePrefix</span><span class="p">)</span>
                            <span class="p">,(</span><span class="s2">&quot;backgroundGenerator&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">backgroundGenerator</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">())</span>
                            <span class="p">,(</span><span class="s2">&quot;embedders&quot;</span><span class="p">,[</span><span class="n">x</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">embedders</span><span class="p">])</span>
                            <span class="p">]);</span></div></div>

<div class="viewcode-block" id="AbstractPriorEmbeddedThings"><a class="viewcode-back" href="../synthetic.html#synthetic.AbstractPriorEmbeddedThings">[docs]</a><span class="k">class</span> <span class="nc">AbstractPriorEmbeddedThings</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        class that is used to keep track of what has already been embedded in a sequence</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="AbstractPriorEmbeddedThings.canEmbed"><a class="viewcode-back" href="../synthetic.html#synthetic.AbstractPriorEmbeddedThings.canEmbed">[docs]</a>    <span class="k">def</span> <span class="nf">canEmbed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">startPos</span><span class="p">,</span> <span class="n">endPos</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            returns a boolean indicating whether the region from startPos to endPos is available for embedding</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">();</span></div>
<div class="viewcode-block" id="AbstractPriorEmbeddedThings.addEmbedding"><a class="viewcode-back" href="../synthetic.html#synthetic.AbstractPriorEmbeddedThings.addEmbedding">[docs]</a>    <span class="k">def</span> <span class="nf">addEmbedding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">startPos</span><span class="p">,</span> <span class="n">what</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            embeds &quot;what&quot; from startPos to startPos+len(what). Creates an Embedding object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">();</span></div>
<div class="viewcode-block" id="AbstractPriorEmbeddedThings.getNumOccupiedPos"><a class="viewcode-back" href="../synthetic.html#synthetic.AbstractPriorEmbeddedThings.getNumOccupiedPos">[docs]</a>    <span class="k">def</span> <span class="nf">getNumOccupiedPos</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            returns the number of posiitons that are filled with some kind of embedding</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">();</span></div>
<div class="viewcode-block" id="AbstractPriorEmbeddedThings.getTotalPos"><a class="viewcode-back" href="../synthetic.html#synthetic.AbstractPriorEmbeddedThings.getTotalPos">[docs]</a>    <span class="k">def</span> <span class="nf">getTotalPos</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            returns the total number of positions available to embed things in</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">();</span></div>
<div class="viewcode-block" id="AbstractPriorEmbeddedThings.getEmbeddings"><a class="viewcode-back" href="../synthetic.html#synthetic.AbstractPriorEmbeddedThings.getEmbeddings">[docs]</a>    <span class="k">def</span> <span class="nf">getEmbeddings</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            returns a collection of Embedding objects</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">();</span></div></div>

<div class="viewcode-block" id="PriorEmbeddedThings_numpyArrayBacked"><a class="viewcode-back" href="../synthetic.html#synthetic.PriorEmbeddedThings_numpyArrayBacked">[docs]</a><span class="k">class</span> <span class="nc">PriorEmbeddedThings_numpyArrayBacked</span><span class="p">(</span><span class="n">AbstractPriorEmbeddedThings</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        uses a numpy array where positions are set to 1 if they are occupied,</span>
<span class="sd">        to determin which positions are occupied and which are not.</span>
<span class="sd">        See parent for more documentation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seqLen</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            seqLen: integer indicating length of the sequence you are embedding in</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seqLen</span> <span class="o">=</span> <span class="n">seqLen</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">seqLen</span><span class="p">);</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">embeddings</span> <span class="o">=</span> <span class="p">[];</span>
<div class="viewcode-block" id="PriorEmbeddedThings_numpyArrayBacked.canEmbed"><a class="viewcode-back" href="../synthetic.html#synthetic.PriorEmbeddedThings_numpyArrayBacked.canEmbed">[docs]</a>    <span class="k">def</span> <span class="nf">canEmbed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">startPos</span><span class="p">,</span> <span class="n">endPos</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">arr</span><span class="p">[</span><span class="n">startPos</span><span class="p">:</span><span class="n">endPos</span><span class="p">])</span><span class="o">==</span><span class="mi">0</span><span class="p">;</span></div>
<div class="viewcode-block" id="PriorEmbeddedThings_numpyArrayBacked.addEmbedding"><a class="viewcode-back" href="../synthetic.html#synthetic.PriorEmbeddedThings_numpyArrayBacked.addEmbedding">[docs]</a>    <span class="k">def</span> <span class="nf">addEmbedding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">startPos</span><span class="p">,</span> <span class="n">what</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            what: instance of Embeddable</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">arr</span><span class="p">[</span><span class="n">startPos</span><span class="p">:</span><span class="n">startPos</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">what</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">embeddings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Embedding</span><span class="p">(</span><span class="n">what</span><span class="o">=</span><span class="n">what</span><span class="p">,</span> <span class="n">startPos</span><span class="o">=</span><span class="n">startPos</span><span class="p">));</span></div>
<div class="viewcode-block" id="PriorEmbeddedThings_numpyArrayBacked.getNumOccupiedPos"><a class="viewcode-back" href="../synthetic.html#synthetic.PriorEmbeddedThings_numpyArrayBacked.getNumOccupiedPos">[docs]</a>    <span class="k">def</span> <span class="nf">getNumOccupiedPos</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">arr</span><span class="p">);</span></div>
<div class="viewcode-block" id="PriorEmbeddedThings_numpyArrayBacked.getTotalPos"><a class="viewcode-back" href="../synthetic.html#synthetic.PriorEmbeddedThings_numpyArrayBacked.getTotalPos">[docs]</a>    <span class="k">def</span> <span class="nf">getTotalPos</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">arr</span><span class="p">);</span></div>
<div class="viewcode-block" id="PriorEmbeddedThings_numpyArrayBacked.getEmbeddings"><a class="viewcode-back" href="../synthetic.html#synthetic.PriorEmbeddedThings_numpyArrayBacked.getEmbeddings">[docs]</a>    <span class="k">def</span> <span class="nf">getEmbeddings</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">embeddings</span><span class="p">;</span></div></div>

<div class="viewcode-block" id="AbstractEmbeddable"><a class="viewcode-back" href="../synthetic.html#synthetic.AbstractEmbeddable">[docs]</a><span class="k">class</span> <span class="nc">AbstractEmbeddable</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Represents a thing which can be embedded. Note that</span>
<span class="sd">        an Embeddable + a position = an embedding.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">();</span>
    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">();</span>
<div class="viewcode-block" id="AbstractEmbeddable.getDescription"><a class="viewcode-back" href="../synthetic.html#synthetic.AbstractEmbeddable.getDescription">[docs]</a>    <span class="k">def</span> <span class="nf">getDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">();</span></div>
<div class="viewcode-block" id="AbstractEmbeddable.canEmbed"><a class="viewcode-back" href="../synthetic.html#synthetic.AbstractEmbeddable.canEmbed">[docs]</a>    <span class="k">def</span> <span class="nf">canEmbed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">priorEmbeddedThings</span><span class="p">,</span> <span class="n">startPos</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            priorEmbeddedThings: instance of AbstractPriorEmbeddedThings</span>
<span class="sd">            startPos: the position you are considering embedding self at</span>
<span class="sd">            returns a boolean indicating whether self can be embedded at startPos, </span>
<span class="sd">                given the things that have already been embedded.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">();</span></div>
<div class="viewcode-block" id="AbstractEmbeddable.embedInBackgroundStringArr"><a class="viewcode-back" href="../synthetic.html#synthetic.AbstractEmbeddable.embedInBackgroundStringArr">[docs]</a>    <span class="k">def</span> <span class="nf">embedInBackgroundStringArr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">priorEmbeddedThings</span><span class="p">,</span> <span class="n">backgroundStringArr</span><span class="p">,</span> <span class="n">startPos</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Will embed self at startPos in backgroundStringArr, and will update priorEmbeddedThings.</span>
<span class="sd">            priorEmbeddedThings: instance of AbstractPriorEmbeddedThings</span>
<span class="sd">            backgroundStringArr: an array of characters representing the background</span>
<span class="sd">            startPos: the position to embed self at</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">();</span> </div></div>

<div class="viewcode-block" id="StringEmbeddable"><a class="viewcode-back" href="../synthetic.html#synthetic.StringEmbeddable">[docs]</a><span class="k">class</span> <span class="nc">StringEmbeddable</span><span class="p">(</span><span class="n">AbstractEmbeddable</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        represents a string (such as a sampling from a pwm) that is to</span>
<span class="sd">        be embedded in a background. See docs for superclass.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">string</span><span class="p">,</span> <span class="n">stringDescription</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">string</span> <span class="o">=</span> <span class="n">string</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stringDescription</span> <span class="o">=</span> <span class="n">stringDescription</span><span class="p">;</span>
    <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">string</span><span class="p">);</span>
    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">stringDescription</span><span class="o">+</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stringDescription</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">string</span><span class="p">;</span>
<div class="viewcode-block" id="StringEmbeddable.getDescription"><a class="viewcode-back" href="../synthetic.html#synthetic.StringEmbeddable.getDescription">[docs]</a>    <span class="k">def</span> <span class="nf">getDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">stringDescription</span><span class="p">;</span></div>
<div class="viewcode-block" id="StringEmbeddable.canEmbed"><a class="viewcode-back" href="../synthetic.html#synthetic.StringEmbeddable.canEmbed">[docs]</a>    <span class="k">def</span> <span class="nf">canEmbed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">priorEmbeddedThings</span><span class="p">,</span> <span class="n">startPos</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">priorEmbeddedThings</span><span class="o">.</span><span class="n">canEmbed</span><span class="p">(</span><span class="n">startPos</span><span class="p">,</span> <span class="n">startPos</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">string</span><span class="p">))</span></div>
<div class="viewcode-block" id="StringEmbeddable.embedInBackgroundStringArr"><a class="viewcode-back" href="../synthetic.html#synthetic.StringEmbeddable.embedInBackgroundStringArr">[docs]</a>    <span class="k">def</span> <span class="nf">embedInBackgroundStringArr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">priorEmbeddedThings</span><span class="p">,</span> <span class="n">backgroundStringArr</span><span class="p">,</span> <span class="n">startPos</span><span class="p">):</span>
        <span class="n">backgroundStringArr</span><span class="p">[</span><span class="n">startPos</span><span class="p">:</span><span class="n">startPos</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">string</span><span class="p">)]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">string</span><span class="p">;</span>
        <span class="n">priorEmbeddedThings</span><span class="o">.</span><span class="n">addEmbedding</span><span class="p">(</span><span class="n">startPos</span><span class="p">,</span> <span class="bp">self</span><span class="p">);</span></div>
    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="StringEmbeddable.fromString"><a class="viewcode-back" href="../synthetic.html#synthetic.StringEmbeddable.fromString">[docs]</a>    <span class="k">def</span> <span class="nf">fromString</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">theString</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="ow">in</span> <span class="n">theString</span><span class="p">):</span>
            <span class="n">stringDescription</span><span class="p">,</span> <span class="n">coreString</span> <span class="o">=</span> <span class="n">theString</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">);</span>
            <span class="k">return</span> <span class="n">cls</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">coreString</span><span class="p">,</span> <span class="n">stringDescription</span><span class="o">=</span><span class="n">stringDescription</span><span class="p">);</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">cls</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">theString</span><span class="p">);</span> </div></div>

<div class="viewcode-block" id="PairEmbeddable_General"><a class="viewcode-back" href="../synthetic.html#synthetic.PairEmbeddable_General">[docs]</a><span class="k">class</span> <span class="nc">PairEmbeddable_General</span><span class="p">(</span><span class="n">AbstractEmbeddable</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        embeds two Embeddable objects with some sep</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">embeddable1</span><span class="p">,</span> <span class="n">embeddable2</span><span class="p">,</span> <span class="n">separation</span><span class="p">,</span> <span class="n">embeddableDescription</span><span class="p">,</span> <span class="n">nothingInBetween</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">embeddable1</span><span class="o">=</span><span class="n">embeddable1</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">embeddable2</span><span class="o">=</span><span class="n">embeddable2</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">separation</span><span class="o">=</span><span class="n">separation</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">embeddableDescription</span><span class="o">=</span><span class="n">embeddableDescription</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nothingInBetween</span><span class="o">=</span><span class="n">nothingInBetween</span><span class="p">;</span>
    <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">embeddable1</span><span class="p">)</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">separation</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">embeddable2</span><span class="p">);</span>
    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">embeddableDescription</span><span class="o">+</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="k">if</span> <span class="n">embeddableDescription</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">embeddable1</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;-Gap&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">separation</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;-&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">embeddable2</span><span class="p">);</span>
<div class="viewcode-block" id="PairEmbeddable_General.getDescription"><a class="viewcode-back" href="../synthetic.html#synthetic.PairEmbeddable_General.getDescription">[docs]</a>    <span class="k">def</span> <span class="nf">getDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">embeddableDescription</span><span class="p">;</span></div>
<div class="viewcode-block" id="PairEmbeddable_General.canEmbed"><a class="viewcode-back" href="../synthetic.html#synthetic.PairEmbeddable_General.canEmbed">[docs]</a>    <span class="k">def</span> <span class="nf">canEmbed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">priorEmbeddedThings</span><span class="p">,</span> <span class="n">startPos</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nothingInBetween</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">priorEmbeddedThings</span><span class="o">.</span><span class="n">canEmbed</span><span class="p">(</span><span class="n">startPos</span><span class="p">,</span> <span class="n">startPos</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">));</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">priorEmbeddedThings</span><span class="o">.</span><span class="n">canEmbed</span><span class="p">(</span><span class="n">startPos</span><span class="p">,</span><span class="n">startPos</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">embeddable1</span><span class="p">))</span>
                    <span class="ow">and</span> <span class="n">priorEmbeddedThings</span><span class="o">.</span><span class="n">canEmbed</span><span class="p">(</span><span class="n">startPos</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">embeddable1</span><span class="p">)</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">separation</span><span class="p">,</span> <span class="n">startPos</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)));</span></div>
<div class="viewcode-block" id="PairEmbeddable_General.embedInBackgroundStringArr"><a class="viewcode-back" href="../synthetic.html#synthetic.PairEmbeddable_General.embedInBackgroundStringArr">[docs]</a>    <span class="k">def</span> <span class="nf">embedInBackgroundStringArr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">priorEmbeddedThings</span><span class="p">,</span> <span class="n">backgroundStringArr</span><span class="p">,</span> <span class="n">startPos</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">embeddable1</span><span class="o">.</span><span class="n">embedInBackgroundStringArr</span><span class="p">(</span><span class="n">priorEmbeddedThings</span><span class="p">,</span> <span class="n">backgroundStringArr</span><span class="p">,</span> <span class="n">startPos</span><span class="p">);</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">embeddable2</span><span class="o">.</span><span class="n">embedInBackgroundStringArr</span><span class="p">(</span><span class="n">priorEmbeddedThings</span><span class="p">,</span> <span class="n">backgroundStringArr</span><span class="p">,</span> <span class="n">startPos</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">separation</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nothingInBetween</span><span class="p">):</span>
            <span class="n">priorEmbeddedThings</span><span class="o">.</span><span class="n">addEmbedding</span><span class="p">(</span><span class="n">startPos</span><span class="p">,</span> <span class="bp">self</span><span class="p">);</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">priorEmbeddedThings</span><span class="o">.</span><span class="n">addEmbedding</span><span class="p">(</span><span class="n">startPos</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">embeddable1</span><span class="p">);</span>
            <span class="n">priorEmbeddedThings</span><span class="o">.</span><span class="n">addEmbedding</span><span class="p">(</span><span class="n">startPos</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">string1</span><span class="p">)</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">separation</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">embeddable2</span><span class="p">);</span></div></div>


<div class="viewcode-block" id="PairEmbeddable"><a class="viewcode-back" href="../synthetic.html#synthetic.PairEmbeddable">[docs]</a><span class="k">class</span> <span class="nc">PairEmbeddable</span><span class="p">(</span><span class="n">AbstractEmbeddable</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Represents a pair of strings that are embedded with some separation.</span>
<span class="sd">        Used for motif grammars. See superclass docs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">string1</span><span class="p">,</span> <span class="n">string2</span><span class="p">,</span> <span class="n">separation</span><span class="p">,</span> <span class="n">embeddableDescription</span><span class="p">,</span> <span class="n">nothingInBetween</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            separation: int of positions separating</span>
<span class="sd">                string1 and string2</span>
<span class="sd">            nothingInBetween: if true, then nothing else is allowed to be</span>
<span class="sd">                embedded in the gap between string1 and string2.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">string1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="k">assert</span> <span class="n">string2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">string1</span> <span class="o">=</span> <span class="n">string1</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">string2</span> <span class="o">=</span> <span class="n">string2</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">separation</span> <span class="o">=</span> <span class="n">separation</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">embeddableDescription</span> <span class="o">=</span> <span class="n">embeddableDescription</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nothingInBetween</span> <span class="o">=</span> <span class="n">nothingInBetween</span><span class="p">;</span>
    <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">string1</span><span class="p">)</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">separation</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">string2</span><span class="p">);</span>
    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">embeddableDescription</span><span class="o">+</span><span class="s2">&quot;-&quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">string1</span><span class="o">+</span><span class="s2">&quot;-Gap&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">separation</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;-&quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">string2</span><span class="p">;</span>
<div class="viewcode-block" id="PairEmbeddable.getDescription"><a class="viewcode-back" href="../synthetic.html#synthetic.PairEmbeddable.getDescription">[docs]</a>    <span class="k">def</span> <span class="nf">getDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">embeddableDescription</span><span class="p">;</span></div>
<div class="viewcode-block" id="PairEmbeddable.canEmbed"><a class="viewcode-back" href="../synthetic.html#synthetic.PairEmbeddable.canEmbed">[docs]</a>    <span class="k">def</span> <span class="nf">canEmbed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">priorEmbeddedThings</span><span class="p">,</span> <span class="n">startPos</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nothingInBetween</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">priorEmbeddedThings</span><span class="o">.</span><span class="n">canEmbed</span><span class="p">(</span><span class="n">startPos</span><span class="p">,</span> <span class="n">startPos</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">));</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">priorEmbeddedThings</span><span class="o">.</span><span class="n">canEmbed</span><span class="p">(</span><span class="n">startPos</span><span class="p">,</span><span class="n">startPos</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">string1</span><span class="p">))</span>
                    <span class="ow">and</span> <span class="n">priorEmbeddedThings</span><span class="o">.</span><span class="n">canEmbed</span><span class="p">(</span><span class="n">startPos</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">string1</span><span class="p">)</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">separation</span><span class="p">,</span> <span class="n">startPos</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)));</span></div>
<div class="viewcode-block" id="PairEmbeddable.embedInBackgroundStringArr"><a class="viewcode-back" href="../synthetic.html#synthetic.PairEmbeddable.embedInBackgroundStringArr">[docs]</a>    <span class="k">def</span> <span class="nf">embedInBackgroundStringArr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">priorEmbeddedThings</span><span class="p">,</span> <span class="n">backgroundStringArr</span><span class="p">,</span> <span class="n">startPos</span><span class="p">):</span>
        <span class="n">backgroundStringArr</span><span class="p">[</span><span class="n">startPos</span><span class="p">:</span><span class="n">startPos</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">string1</span><span class="p">)]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">string1</span><span class="p">;</span>
        <span class="n">backgroundStringArr</span><span class="p">[</span><span class="n">startPos</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">string1</span><span class="p">)</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">separation</span><span class="p">:</span><span class="n">startPos</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">string2</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nothingInBetween</span><span class="p">):</span>
            <span class="n">priorEmbeddedThings</span><span class="o">.</span><span class="n">addEmbedding</span><span class="p">(</span><span class="n">startPos</span><span class="p">,</span> <span class="bp">self</span><span class="p">);</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">priorEmbeddedThings</span><span class="o">.</span><span class="n">addEmbedding</span><span class="p">(</span><span class="n">startPos</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">string1</span><span class="p">);</span>
            <span class="n">priorEmbeddedThings</span><span class="o">.</span><span class="n">addEmbedding</span><span class="p">(</span><span class="n">startPos</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">string1</span><span class="p">)</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">separation</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">string2</span><span class="p">);</span></div></div>

<div class="viewcode-block" id="AbstractEmbedder"><a class="viewcode-back" href="../synthetic.html#synthetic.AbstractEmbedder">[docs]</a><span class="k">class</span> <span class="nc">AbstractEmbedder</span><span class="p">(</span><span class="n">DefaultNameMixin</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        class that is used to embed things in a sequence</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="AbstractEmbedder.embed"><a class="viewcode-back" href="../synthetic.html#synthetic.AbstractEmbedder.embed">[docs]</a>    <span class="k">def</span> <span class="nf">embed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">backgroundStringArr</span><span class="p">,</span> <span class="n">priorEmbeddedThings</span><span class="p">,</span> <span class="n">additionalInfo</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; </span>
<span class="sd">            backgroundStringArr: array of characters representing the background string</span>
<span class="sd">            priorEmbeddedThings: instance of AbstractPriorEmbeddedThings.</span>
<span class="sd">            additionalInfo: instance of AdditionalInfo; allows the embedder to send back info about what it did</span>
<span class="sd">            modifies: backgroundStringArr to include whatever this class has embedded</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">additionalInfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
            <span class="n">additionalInfo</span><span class="o">.</span><span class="n">updateTrace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">);</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_embed</span><span class="p">(</span><span class="n">backgroundStringArr</span><span class="p">,</span> <span class="n">priorEmbeddedThings</span><span class="p">,</span> <span class="n">additionalInfo</span><span class="p">);</span></div>
    <span class="k">def</span> <span class="nf">_embed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">backgroundStringArr</span><span class="p">,</span> <span class="n">priorEmbeddedThings</span><span class="p">,</span> <span class="n">additionalInfo</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">();</span>    
<div class="viewcode-block" id="AbstractEmbedder.getJsonableObject"><a class="viewcode-back" href="../synthetic.html#synthetic.AbstractEmbedder.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">();</span></div></div>

<div class="viewcode-block" id="EmbeddableEmbedder"><a class="viewcode-back" href="../synthetic.html#synthetic.EmbeddableEmbedder">[docs]</a><span class="k">class</span> <span class="nc">EmbeddableEmbedder</span><span class="p">(</span><span class="n">AbstractEmbedder</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Embeds instances of AbstractEmbeddable within the background sequence,</span>
<span class="sd">        at a position sampled from a distribution. Only embeds at unoccupied</span>
<span class="sd">        positions</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">embeddableGenerator</span><span class="p">,</span> <span class="n">positionGenerator</span><span class="o">=</span><span class="n">uniformPositionGenerator</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            embeddableGenerator: instance of AbstractEmbeddableGenerator</span>
<span class="sd">            positionGenerator: instance of AbstractPositionGenerator</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">embeddableGenerator</span> <span class="o">=</span> <span class="n">embeddableGenerator</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">positionGenerator</span> <span class="o">=</span> <span class="n">positionGenerator</span><span class="p">;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">EmbeddableEmbedder</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
    <span class="k">def</span> <span class="nf">_embed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">backgroundStringArr</span><span class="p">,</span> <span class="n">priorEmbeddedThings</span><span class="p">,</span> <span class="n">additionalInfo</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            calls self.embeddableGenerator to determine the embeddable to embed. Then</span>
<span class="sd">            calls self.positionGenerator to determine the start position at which</span>
<span class="sd">            to embed it. If the position is occupied, will resample from</span>
<span class="sd">            self.positionGenerator. Will warn if tries to resample too many times.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">embeddable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">embeddableGenerator</span><span class="o">.</span><span class="n">generateEmbeddable</span><span class="p">();</span>
        <span class="n">canEmbed</span> <span class="o">=</span> <span class="kc">False</span><span class="p">;</span>
        <span class="n">tries</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">while</span> <span class="n">canEmbed</span><span class="o">==</span><span class="kc">False</span><span class="p">:</span>
            <span class="n">tries</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
            <span class="n">startPos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">positionGenerator</span><span class="o">.</span><span class="n">generatePos</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">backgroundStringArr</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">embeddable</span><span class="p">),</span> <span class="n">additionalInfo</span><span class="p">);</span>
            <span class="n">canEmbed</span> <span class="o">=</span> <span class="n">embeddable</span><span class="o">.</span><span class="n">canEmbed</span><span class="p">(</span><span class="n">priorEmbeddedThings</span><span class="p">,</span> <span class="n">startPos</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">tries</span><span class="o">%</span><span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning: made &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">tries</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot; at trying to embed &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">embeddable</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot; in region of length &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">priorEmbeddedThings</span><span class="o">.</span><span class="n">getTotalPos</span><span class="p">())</span><span class="o">+</span><span class="s2">&quot; with &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">priorEmbeddedThings</span><span class="o">.</span><span class="n">getNumOccupiedPos</span><span class="p">())</span><span class="o">+</span><span class="s2">&quot; occupied sites&quot;</span><span class="p">);</span>
        <span class="n">embeddable</span><span class="o">.</span><span class="n">embedInBackgroundStringArr</span><span class="p">(</span><span class="n">priorEmbeddedThings</span><span class="p">,</span> <span class="n">backgroundStringArr</span><span class="p">,</span> <span class="n">startPos</span><span class="p">);</span>
<div class="viewcode-block" id="EmbeddableEmbedder.getJsonableObject"><a class="viewcode-back" href="../synthetic.html#synthetic.EmbeddableEmbedder.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="s2">&quot;embeddableGenerator&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">embeddableGenerator</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">())</span>
                            <span class="p">,</span> <span class="p">(</span><span class="s2">&quot;positionGenerator&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">positionGenerator</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">())]);</span></div></div>

<div class="viewcode-block" id="XOREmbedder"><a class="viewcode-back" href="../synthetic.html#synthetic.XOREmbedder">[docs]</a><span class="k">class</span> <span class="nc">XOREmbedder</span><span class="p">(</span><span class="n">AbstractEmbedder</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        calls exactly one of the supplied embedders</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">embedder1</span><span class="p">,</span> <span class="n">embedder2</span><span class="p">,</span> <span class="n">probOfFirst</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            embedder1 &amp; embedder2: instances of AbstractEmbedder</span>
<span class="sd">            probOfFirst: probability of calling the first embedder</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">embedder1</span> <span class="o">=</span> <span class="n">embedder1</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">embedder2</span> <span class="o">=</span> <span class="n">embedder2</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">probOfFirst</span> <span class="o">=</span> <span class="n">probOfFirst</span><span class="p">;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">XOREmbedder</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
    <span class="k">def</span> <span class="nf">_embed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">backgroundStringArr</span><span class="p">,</span> <span class="n">priorEmbeddedThings</span><span class="p">,</span> <span class="n">additionalInfo</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">probOfFirst</span><span class="p">):</span>
            <span class="n">embedder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">embedder1</span><span class="p">;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">embedder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">embedder2</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">embedder</span><span class="o">.</span><span class="n">embed</span><span class="p">(</span><span class="n">backgroundStringArr</span><span class="p">,</span> <span class="n">priorEmbeddedThings</span><span class="p">,</span> <span class="n">additionalInfo</span><span class="p">);</span>
<div class="viewcode-block" id="XOREmbedder.getJsonableObject"><a class="viewcode-back" href="../synthetic.html#synthetic.XOREmbedder.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">OrderedDict</span><span class="p">([</span> <span class="p">(</span><span class="s2">&quot;class&quot;</span><span class="p">,</span> <span class="s2">&quot;XOREmbedder&quot;</span><span class="p">)</span>
                            <span class="p">,(</span><span class="s2">&quot;embedder1&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">embedder1</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">())</span>
                            <span class="p">,(</span><span class="s2">&quot;embedder2&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">embedder2</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">())</span>
                            <span class="p">,(</span><span class="s2">&quot;probOfFirst&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">probOfFirst</span><span class="p">)]);</span></div></div>

<div class="viewcode-block" id="AllEmbedders"><a class="viewcode-back" href="../synthetic.html#synthetic.AllEmbedders">[docs]</a><span class="k">class</span> <span class="nc">AllEmbedders</span><span class="p">(</span><span class="n">AbstractEmbedder</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Wrapper around a list of embedders to make sure all are called</span>
<span class="sd">        Useful in conjunciton with RandomSubsetOfEmbedders</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">embedders</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">embedders</span> <span class="o">=</span> <span class="n">embedders</span><span class="p">;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">AllEmbedders</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
    <span class="k">def</span> <span class="nf">_embed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">backgroundStringArr</span><span class="p">,</span> <span class="n">priorEmbeddedThings</span><span class="p">,</span> <span class="n">additionalInfo</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">embedder</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">embedders</span><span class="p">:</span>
            <span class="n">embedder</span><span class="o">.</span><span class="n">embed</span><span class="p">(</span><span class="n">backgroundStringArr</span><span class="p">,</span> <span class="n">priorEmbeddedThings</span><span class="p">,</span> <span class="n">additionalInfo</span><span class="p">);</span>
<div class="viewcode-block" id="AllEmbedders.getJsonableObject"><a class="viewcode-back" href="../synthetic.html#synthetic.AllEmbedders.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="s2">&quot;class&quot;</span><span class="p">,</span> <span class="s2">&quot;AllEmbedders&quot;</span><span class="p">)</span>
                            <span class="p">,(</span><span class="s2">&quot;embedders&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">embedders</span><span class="p">])</span>
                            <span class="p">]);</span></div></div>

<div class="viewcode-block" id="RandomSubsetOfEmbedders"><a class="viewcode-back" href="../synthetic.html#synthetic.RandomSubsetOfEmbedders">[docs]</a><span class="k">class</span> <span class="nc">RandomSubsetOfEmbedders</span><span class="p">(</span><span class="n">AbstractEmbedder</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Takes a quantity generator that generates a quantity of</span>
<span class="sd">        embedders, and executes that many embedders from a supplied set,</span>
<span class="sd">        in sequence</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">quantityGenerator</span><span class="p">,</span> <span class="n">embedders</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            quantityGenerator: instance of AbstractQuantityGenerator</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">quantityGenerator</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
            <span class="n">quantityGenerator</span> <span class="o">=</span> <span class="n">FixedQuantityGenerator</span><span class="p">(</span><span class="n">quantityGenerator</span><span class="p">);</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">quantityGenerator</span><span class="p">,</span> <span class="n">AbstractQuantityGenerator</span><span class="p">);</span>  
        <span class="bp">self</span><span class="o">.</span><span class="n">quantityGenerator</span> <span class="o">=</span> <span class="n">quantityGenerator</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">embedders</span> <span class="o">=</span> <span class="n">embedders</span><span class="p">;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">RandomSubsetOfEmbedders</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
    <span class="k">def</span> <span class="nf">_embed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">backgroundStringArr</span><span class="p">,</span> <span class="n">priorEmbeddedThings</span><span class="p">,</span> <span class="n">additionalInfo</span><span class="p">):</span>
        <span class="n">numberOfEmbeddersToSample</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">quantityGenerator</span><span class="o">.</span><span class="n">generateQuantity</span><span class="p">();</span>  
        <span class="k">if</span> <span class="p">(</span><span class="n">numberOfEmbeddersToSample</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">embedders</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;numberOfEmbeddersToSample came up as &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">numberOfEmbeddersToSample</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot; but total number of embedders is &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">embedders</span><span class="p">)));</span>
        <span class="n">sampledEmbedders</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">sampleWithoutReplacement</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">embedders</span><span class="p">,</span> <span class="n">numberOfEmbeddersToSample</span><span class="p">);</span>
        <span class="k">for</span> <span class="n">embedder</span> <span class="ow">in</span> <span class="n">sampledEmbedders</span><span class="p">:</span>
            <span class="n">embedder</span><span class="o">.</span><span class="n">embed</span><span class="p">(</span><span class="n">backgroundStringArr</span><span class="p">,</span> <span class="n">priorEmbeddedThings</span><span class="p">,</span> <span class="n">additionalInfo</span><span class="p">);</span>
<div class="viewcode-block" id="RandomSubsetOfEmbedders.getJsonableObject"><a class="viewcode-back" href="../synthetic.html#synthetic.RandomSubsetOfEmbedders.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">OrderedDict</span><span class="p">([</span> <span class="p">(</span><span class="s2">&quot;class&quot;</span><span class="p">,</span> <span class="s2">&quot;RandomSubsetOfEmbedders&quot;</span><span class="p">)</span>
                             <span class="p">,(</span><span class="s2">&quot;setOfEmbedders&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">embedders</span><span class="p">])]);</span></div></div>

<div class="viewcode-block" id="RepeatedEmbedder"><a class="viewcode-back" href="../synthetic.html#synthetic.RepeatedEmbedder">[docs]</a><span class="k">class</span> <span class="nc">RepeatedEmbedder</span><span class="p">(</span><span class="n">AbstractEmbedder</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Wrapper around an embedder to call it multiple times according to sampling</span>
<span class="sd">        from a distribution.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">embedder</span><span class="p">,</span> <span class="n">quantityGenerator</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            embedder: instance of AbstractEmbedder</span>
<span class="sd">            quantityGenerator: instance of AbstractQuantityGenerator</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">embedder</span> <span class="o">=</span> <span class="n">embedder</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quantityGenerator</span> <span class="o">=</span> <span class="n">quantityGenerator</span><span class="p">;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">RepeatedEmbedder</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
    <span class="k">def</span> <span class="nf">_embed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">backgroundStringArr</span><span class="p">,</span> <span class="n">priorEmbeddedThings</span><span class="p">,</span> <span class="n">additionalInfo</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            first calls self.quantityGenerator.generateQuantity(), then calls</span>
<span class="sd">            self.embedder a number of times equal to the value returned.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">quantity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">quantityGenerator</span><span class="o">.</span><span class="n">generateQuantity</span><span class="p">();</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">quantity</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">embedder</span><span class="o">.</span><span class="n">embed</span><span class="p">(</span><span class="n">backgroundStringArr</span><span class="p">,</span> <span class="n">priorEmbeddedThings</span><span class="p">,</span> <span class="n">additionalInfo</span><span class="p">);</span>
<div class="viewcode-block" id="RepeatedEmbedder.getJsonableObject"><a class="viewcode-back" href="../synthetic.html#synthetic.RepeatedEmbedder.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="s2">&quot;class&quot;</span><span class="p">,</span> <span class="s2">&quot;RepeatedEmbedder&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;embedder&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">embedder</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">()),</span> <span class="p">(</span><span class="s2">&quot;quantityGenerator&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">quantityGenerator</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">())]);</span></div></div>

<div class="viewcode-block" id="AbstractQuantityGenerator"><a class="viewcode-back" href="../synthetic.html#synthetic.AbstractQuantityGenerator">[docs]</a><span class="k">class</span> <span class="nc">AbstractQuantityGenerator</span><span class="p">(</span><span class="n">DefaultNameMixin</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        class to sample according to a distribution</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="AbstractQuantityGenerator.generateQuantity"><a class="viewcode-back" href="../synthetic.html#synthetic.AbstractQuantityGenerator.generateQuantity">[docs]</a>    <span class="k">def</span> <span class="nf">generateQuantity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            returns the sampled value</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">();</span></div>
<div class="viewcode-block" id="AbstractQuantityGenerator.getJsonableObject"><a class="viewcode-back" href="../synthetic.html#synthetic.AbstractQuantityGenerator.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">();</span></div></div>

<div class="viewcode-block" id="ChooseValueFromASet"><a class="viewcode-back" href="../synthetic.html#synthetic.ChooseValueFromASet">[docs]</a><span class="k">class</span> <span class="nc">ChooseValueFromASet</span><span class="p">(</span><span class="n">AbstractQuantityGenerator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Randomly samples a particular value from a set of values</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">setOfPossibleValues</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setOfPossibleValues</span> <span class="o">=</span> <span class="n">setOfPossibleValues</span><span class="p">;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ChooseValueFromASet</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
<div class="viewcode-block" id="ChooseValueFromASet.generateQuantity"><a class="viewcode-back" href="../synthetic.html#synthetic.ChooseValueFromASet.generateQuantity">[docs]</a>    <span class="k">def</span> <span class="nf">generateQuantity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">setOfPossibleValues</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span><span class="o">*</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setOfPossibleValues</span><span class="p">)))];</span></div>
<div class="viewcode-block" id="ChooseValueFromASet.getJsonableObject"><a class="viewcode-back" href="../synthetic.html#synthetic.ChooseValueFromASet.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="s2">&quot;class&quot;</span><span class="p">,</span><span class="s2">&quot;ChooseValueFromASet&quot;</span><span class="p">),(</span><span class="s2">&quot;possibleValues&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">setOfPossibleValues</span><span class="p">)]);</span></div></div>

<div class="viewcode-block" id="UniformIntegerGenerator"><a class="viewcode-back" href="../synthetic.html#synthetic.UniformIntegerGenerator">[docs]</a><span class="k">class</span> <span class="nc">UniformIntegerGenerator</span><span class="p">(</span><span class="n">AbstractQuantityGenerator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Randomly samples an integer from minVal to maxVal, inclusive.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">minVal</span><span class="p">,</span> <span class="n">maxVal</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minVal</span> <span class="o">=</span> <span class="n">minVal</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxVal</span> <span class="o">=</span> <span class="n">maxVal</span><span class="p">;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">UniformIntegerGenerator</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
<div class="viewcode-block" id="UniformIntegerGenerator.generateQuantity"><a class="viewcode-back" href="../synthetic.html#synthetic.UniformIntegerGenerator.generateQuantity">[docs]</a>    <span class="k">def</span> <span class="nf">generateQuantity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">minVal</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">maxVal</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">minVal</span><span class="p">));</span> <span class="c1">#the 1+ makes the max val inclusive</span></div>
<div class="viewcode-block" id="UniformIntegerGenerator.getJsonableObject"><a class="viewcode-back" href="../synthetic.html#synthetic.UniformIntegerGenerator.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="s2">&quot;class&quot;</span><span class="p">,</span><span class="s2">&quot;UniformIntegerGenerator&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;minVal&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">minVal</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;maxVal&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">maxVal</span><span class="p">)]);</span></div></div>

<div class="viewcode-block" id="FixedQuantityGenerator"><a class="viewcode-back" href="../synthetic.html#synthetic.FixedQuantityGenerator">[docs]</a><span class="k">class</span> <span class="nc">FixedQuantityGenerator</span><span class="p">(</span><span class="n">AbstractQuantityGenerator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        returns a fixed number every time generateQuantity is called</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">quantity</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            quantity: the value to return when generateQuantity is called.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quantity</span> <span class="o">=</span> <span class="n">quantity</span><span class="p">;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">FixedQuantityGenerator</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
<div class="viewcode-block" id="FixedQuantityGenerator.generateQuantity"><a class="viewcode-back" href="../synthetic.html#synthetic.FixedQuantityGenerator.generateQuantity">[docs]</a>    <span class="k">def</span> <span class="nf">generateQuantity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">quantity</span><span class="p">;</span></div>
<div class="viewcode-block" id="FixedQuantityGenerator.getJsonableObject"><a class="viewcode-back" href="../synthetic.html#synthetic.FixedQuantityGenerator.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;fixedQuantity-&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quantity</span><span class="p">);</span></div></div>

<div class="viewcode-block" id="PoissonQuantityGenerator"><a class="viewcode-back" href="../synthetic.html#synthetic.PoissonQuantityGenerator">[docs]</a><span class="k">class</span> <span class="nc">PoissonQuantityGenerator</span><span class="p">(</span><span class="n">AbstractQuantityGenerator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates values according to a poisson distribution</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            mean: the mean of the poisson distribution</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mean</span> <span class="o">=</span> <span class="n">mean</span><span class="p">;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">PoissonQuantityGenerator</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
<div class="viewcode-block" id="PoissonQuantityGenerator.generateQuantity"><a class="viewcode-back" href="../synthetic.html#synthetic.PoissonQuantityGenerator.generateQuantity">[docs]</a>    <span class="k">def</span> <span class="nf">generateQuantity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">poisson</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">);</span>  </div>
<div class="viewcode-block" id="PoissonQuantityGenerator.getJsonableObject"><a class="viewcode-back" href="../synthetic.html#synthetic.PoissonQuantityGenerator.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;poisson-&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">);</span></div></div>

<div class="viewcode-block" id="BernoulliQuantityGenerator"><a class="viewcode-back" href="../synthetic.html#synthetic.BernoulliQuantityGenerator">[docs]</a><span class="k">class</span> <span class="nc">BernoulliQuantityGenerator</span><span class="p">(</span><span class="n">AbstractQuantityGenerator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates 1 or 0 according to a bernoulli distribution</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prob</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            prob: probability of 1</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prob</span><span class="o">=</span><span class="n">prob</span><span class="p">;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">BernoulliQuantityGenerator</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
<div class="viewcode-block" id="BernoulliQuantityGenerator.generateQuantity"><a class="viewcode-back" href="../synthetic.html#synthetic.BernoulliQuantityGenerator.generateQuantity">[docs]</a>    <span class="k">def</span> <span class="nf">generateQuantity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">1</span> <span class="k">if</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prob</span><span class="p">)</span> <span class="k">else</span> <span class="mi">0</span><span class="p">;</span></div>
<div class="viewcode-block" id="BernoulliQuantityGenerator.getJsonableObject"><a class="viewcode-back" href="../synthetic.html#synthetic.BernoulliQuantityGenerator.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;bernoulli-&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prob</span><span class="p">);</span></div></div>

<div class="viewcode-block" id="MinMaxWrapper"><a class="viewcode-back" href="../synthetic.html#synthetic.MinMaxWrapper">[docs]</a><span class="k">class</span> <span class="nc">MinMaxWrapper</span><span class="p">(</span><span class="n">AbstractQuantityGenerator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Wrapper that restricts a distribution to only return values between the min and</span>
<span class="sd">        the max. If a value outside the range is returned, resamples until</span>
<span class="sd">        it obtains a value within the range. Warns if it resamples too many times.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">quantityGenerator</span><span class="p">,</span> <span class="n">theMin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">theMax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            quantityGenerator: samples from the distribution to truncate</span>
<span class="sd">            theMin: can be None; if so will be ignored</span>
<span class="sd">            theMax: can be None; if so will be ignored.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quantityGenerator</span><span class="o">=</span><span class="n">quantityGenerator</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">theMin</span><span class="o">=</span><span class="n">theMin</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">theMax</span><span class="o">=</span><span class="n">theMax</span><span class="p">;</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">quantityGenerator</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MinMaxWrapper</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
<div class="viewcode-block" id="MinMaxWrapper.generateQuantity"><a class="viewcode-back" href="../synthetic.html#synthetic.MinMaxWrapper.generateQuantity">[docs]</a>    <span class="k">def</span> <span class="nf">generateQuantity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tries</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">(</span><span class="kc">True</span><span class="p">):</span>
            <span class="n">tries</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
            <span class="n">quantity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">quantityGenerator</span><span class="o">.</span><span class="n">generateQuantity</span><span class="p">();</span>
            <span class="k">if</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">theMin</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">quantity</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">theMin</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">theMax</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">quantity</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">theMax</span><span class="p">)):</span>
                <span class="k">return</span> <span class="n">quantity</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">tries</span><span class="o">%</span><span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;warning: made &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">tries</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot; tries at trying to sample from distribution with min/max limits&quot;</span><span class="p">);</span></div>
<div class="viewcode-block" id="MinMaxWrapper.getJsonableObject"><a class="viewcode-back" href="../synthetic.html#synthetic.MinMaxWrapper.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="s2">&quot;min&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">theMin</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;max&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">theMax</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;quantityGenerator&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">quantityGenerator</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">())]);</span></div></div>

<div class="viewcode-block" id="ZeroInflater"><a class="viewcode-back" href="../synthetic.html#synthetic.ZeroInflater">[docs]</a><span class="k">class</span> <span class="nc">ZeroInflater</span><span class="p">(</span><span class="n">AbstractQuantityGenerator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Wrapper that inflates the number of zeros returned. Flips a coin; if positive,</span>
<span class="sd">        will return zero - otherwise will sample from the wrapped distribution (which may still return 0)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">quantityGenerator</span><span class="p">,</span> <span class="n">zeroProb</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            quantityGenerator: the distribution to sample from with probability 1-zeroProb</span>
<span class="sd">            zeroProb: the probability of just returning 0 without sampling from quantityGenerator</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quantityGenerator</span><span class="o">=</span><span class="n">quantityGenerator</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zeroProb</span> <span class="o">=</span> <span class="n">zeroProb</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ZeroInflater</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
<div class="viewcode-block" id="ZeroInflater.generateQuantity"><a class="viewcode-back" href="../synthetic.html#synthetic.ZeroInflater.generateQuantity">[docs]</a>    <span class="k">def</span> <span class="nf">generateQuantity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">val</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">zeroProb</span><span class="p">):</span>
            <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">quantityGenerator</span><span class="o">.</span><span class="n">generateQuantity</span><span class="p">();</span></div>
<div class="viewcode-block" id="ZeroInflater.getJsonableObject"><a class="viewcode-back" href="../synthetic.html#synthetic.ZeroInflater.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="s2">&quot;class&quot;</span><span class="p">,</span> <span class="s2">&quot;ZeroInflater&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;zeroProb&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zeroProb</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;quantityGenerator&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">quantityGenerator</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">())]);</span> </div></div>

<div class="viewcode-block" id="SubstringEmbedder"><a class="viewcode-back" href="../synthetic.html#synthetic.SubstringEmbedder">[docs]</a><span class="k">class</span> <span class="nc">SubstringEmbedder</span><span class="p">(</span><span class="n">EmbeddableEmbedder</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        embeds a single generated substring within the background sequence,</span>
<span class="sd">        at a position sampled from a distribution. Only embeds at unoccupied</span>
<span class="sd">        positions</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">substringGenerator</span><span class="p">,</span> <span class="n">positionGenerator</span><span class="o">=</span><span class="n">uniformPositionGenerator</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            substringGenerator: instance of AbstractSubstringGenerator</span>
<span class="sd">            positionGenerator: instance of AbstractPositionGenerator</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">SubstringEmbedder</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span>
            <span class="n">SubstringEmbeddableGenerator</span><span class="p">(</span><span class="n">substringGenerator</span><span class="p">)</span>
            <span class="p">,</span> <span class="n">positionGenerator</span>
            <span class="p">,</span> <span class="n">name</span><span class="p">);</span></div>

<div class="viewcode-block" id="sampleIndexWithinRegionOfLength"><a class="viewcode-back" href="../synthetic.html#synthetic.sampleIndexWithinRegionOfLength">[docs]</a><span class="k">def</span> <span class="nf">sampleIndexWithinRegionOfLength</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">lengthOfThingToEmbed</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        uniformly at random samples integers from 0 to length-lengthOfThingToEmbedIn</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="n">lengthOfThingToEmbed</span> <span class="o">&lt;=</span> <span class="n">length</span><span class="p">;</span>
    <span class="n">indexToSample</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span><span class="o">*</span><span class="p">((</span><span class="n">length</span><span class="o">-</span><span class="n">lengthOfThingToEmbed</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">));</span>
    <span class="k">return</span> <span class="n">indexToSample</span><span class="p">;</span></div>

<div class="viewcode-block" id="AbstractEmbeddableGenerator"><a class="viewcode-back" href="../synthetic.html#synthetic.AbstractEmbeddableGenerator">[docs]</a><span class="k">class</span> <span class="nc">AbstractEmbeddableGenerator</span><span class="p">(</span><span class="n">DefaultNameMixin</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates an embeddable, usually for embedding in a background sequence.</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="AbstractEmbeddableGenerator.generateEmbeddable"><a class="viewcode-back" href="../synthetic.html#synthetic.AbstractEmbeddableGenerator.generateEmbeddable">[docs]</a>    <span class="k">def</span> <span class="nf">generateEmbeddable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">();</span></div>
<div class="viewcode-block" id="AbstractEmbeddableGenerator.getJsonableObject"><a class="viewcode-back" href="../synthetic.html#synthetic.AbstractEmbeddableGenerator.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">();</span></div></div>

<div class="viewcode-block" id="PairEmbeddableGenerator_General"><a class="viewcode-back" href="../synthetic.html#synthetic.PairEmbeddableGenerator_General">[docs]</a><span class="k">class</span> <span class="nc">PairEmbeddableGenerator_General</span><span class="p">(</span><span class="n">AbstractEmbeddableGenerator</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">embeddableGenerator1</span><span class="p">,</span> <span class="n">embeddableGenerator2</span><span class="p">,</span> <span class="n">separationGenerator</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">embeddableGenerator1</span><span class="o">=</span><span class="n">embeddableGenerator1</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">embeddableGenerator2</span><span class="o">=</span><span class="n">embeddableGenerator2</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">separationGenerator</span><span class="o">=</span><span class="n">separationGenerator</span><span class="p">;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">PairEmbeddableGenerator</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
<div class="viewcode-block" id="PairEmbeddableGenerator_General.generateEmbeddable"><a class="viewcode-back" href="../synthetic.html#synthetic.PairEmbeddableGenerator_General.generateEmbeddable">[docs]</a>    <span class="k">def</span> <span class="nf">generateEmbeddable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">embeddable1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">embeddableGenerator1</span><span class="o">.</span><span class="n">generateEmbeddable</span><span class="p">();</span>
        <span class="n">embeddable2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">embeddableGenerator2</span><span class="o">.</span><span class="n">generateEmbeddable</span><span class="p">();</span>
        <span class="k">return</span> <span class="n">PairEmbeddable</span><span class="p">(</span>
                    <span class="n">embeddable1</span>
                    <span class="p">,</span><span class="n">embeddable2</span>
                    <span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">separationGenerator</span><span class="o">.</span><span class="n">generateQuantity</span><span class="p">()</span>
                    <span class="p">,</span><span class="n">embeddable1</span><span class="o">.</span><span class="n">getDescription</span><span class="p">()</span><span class="o">+</span><span class="s2">&quot;+&quot;</span><span class="o">+</span><span class="n">embeddable2</span><span class="o">.</span><span class="n">getDescription</span><span class="p">()</span>
                <span class="p">);</span></div>
<div class="viewcode-block" id="PairEmbeddableGenerator_General.getJsonableObject"><a class="viewcode-back" href="../synthetic.html#synthetic.PairEmbeddableGenerator_General.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="s2">&quot;class&quot;</span><span class="p">,</span> <span class="s2">&quot;PairEmbeddableGenerator&quot;</span><span class="p">)</span>
                            <span class="p">,(</span><span class="s2">&quot;embeddableGenerator1&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">embeddableGenerator1</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">())</span>
                            <span class="p">,(</span><span class="s2">&quot;embeddableenerator2&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">embeddableGenerator2</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">())</span>
                            <span class="p">,(</span><span class="s2">&quot;separationGenerator&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">separationGenerator</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">())</span>
                            <span class="p">]);</span></div></div>

<div class="viewcode-block" id="PairEmbeddableGenerator"><a class="viewcode-back" href="../synthetic.html#synthetic.PairEmbeddableGenerator">[docs]</a><span class="k">class</span> <span class="nc">PairEmbeddableGenerator</span><span class="p">(</span><span class="n">AbstractEmbeddableGenerator</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">substringGenerator1</span><span class="p">,</span> <span class="n">substringGenerator2</span><span class="p">,</span> <span class="n">separationGenerator</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Specifically for a pair of substrings</span>
<span class="sd">            substringGenerator1: instance of AbstractSubstringGenerator</span>
<span class="sd">            substringGenerator2: instance of AbstractSubstringGenerator</span>
<span class="sd">            separationGenerator: instance of AbstractQuantityGenerator</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">substringGenerator1</span><span class="o">=</span><span class="n">substringGenerator1</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">substringGenerator2</span><span class="o">=</span><span class="n">substringGenerator2</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">separationGenerator</span><span class="o">=</span><span class="n">separationGenerator</span><span class="p">;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">PairEmbeddableGenerator</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
<div class="viewcode-block" id="PairEmbeddableGenerator.generateEmbeddable"><a class="viewcode-back" href="../synthetic.html#synthetic.PairEmbeddableGenerator.generateEmbeddable">[docs]</a>    <span class="k">def</span> <span class="nf">generateEmbeddable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">string1</span><span class="p">,</span> <span class="n">string1Description</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">substringGenerator1</span><span class="o">.</span><span class="n">generateSubstring</span><span class="p">();</span>
        <span class="n">string2</span><span class="p">,</span> <span class="n">string2Description</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">substringGenerator2</span><span class="o">.</span><span class="n">generateSubstring</span><span class="p">();</span>
        <span class="k">return</span> <span class="n">PairEmbeddable</span><span class="p">(</span>
                    <span class="n">string1</span>
                    <span class="p">,</span><span class="n">string2</span>
                    <span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">separationGenerator</span><span class="o">.</span><span class="n">generateQuantity</span><span class="p">()</span>
                    <span class="p">,</span><span class="n">string1Description</span><span class="o">+</span><span class="s2">&quot;+&quot;</span><span class="o">+</span><span class="n">string2Description</span>
                <span class="p">);</span></div>
<div class="viewcode-block" id="PairEmbeddableGenerator.getJsonableObject"><a class="viewcode-back" href="../synthetic.html#synthetic.PairEmbeddableGenerator.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="s2">&quot;class&quot;</span><span class="p">,</span> <span class="s2">&quot;PairEmbeddableGenerator&quot;</span><span class="p">)</span>
                            <span class="p">,(</span><span class="s2">&quot;substringGenerator1&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">substringGenerator1</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">())</span>
                            <span class="p">,(</span><span class="s2">&quot;substringGenerator2&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">substringGenerator2</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">())</span>
                            <span class="p">,(</span><span class="s2">&quot;separationGenerator&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">separationGenerator</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">())</span>
                            <span class="p">]);</span></div></div>

<div class="viewcode-block" id="SubstringEmbeddableGenerator"><a class="viewcode-back" href="../synthetic.html#synthetic.SubstringEmbeddableGenerator">[docs]</a><span class="k">class</span> <span class="nc">SubstringEmbeddableGenerator</span><span class="p">(</span><span class="n">AbstractEmbeddableGenerator</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">substringGenerator</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            substringGenerator: instance of AbstractSubstringGenerator</span>
<span class="sd">        &quot;&quot;&quot;</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">substringGenerator</span> <span class="o">=</span> <span class="n">substringGenerator</span><span class="p">;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">SubstringEmbeddableGenerator</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
<div class="viewcode-block" id="SubstringEmbeddableGenerator.generateEmbeddable"><a class="viewcode-back" href="../synthetic.html#synthetic.SubstringEmbeddableGenerator.generateEmbeddable">[docs]</a>    <span class="k">def</span> <span class="nf">generateEmbeddable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">substring</span><span class="p">,</span> <span class="n">substringDescription</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">substringGenerator</span><span class="o">.</span><span class="n">generateSubstring</span><span class="p">();</span>
        <span class="k">return</span> <span class="n">StringEmbeddable</span><span class="p">(</span><span class="n">substring</span><span class="p">,</span> <span class="n">substringDescription</span><span class="p">);</span></div>
<div class="viewcode-block" id="SubstringEmbeddableGenerator.getJsonableObject"><a class="viewcode-back" href="../synthetic.html#synthetic.SubstringEmbeddableGenerator.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="s2">&quot;class&quot;</span><span class="p">,</span> <span class="s2">&quot;SubstringEmbeddableGenerator&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;substringGenerator&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">substringGenerator</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">())]);</span></div></div>

<div class="viewcode-block" id="AbstractSubstringGenerator"><a class="viewcode-back" href="../synthetic.html#synthetic.AbstractSubstringGenerator">[docs]</a><span class="k">class</span> <span class="nc">AbstractSubstringGenerator</span><span class="p">(</span><span class="n">DefaultNameMixin</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates a substring, usually for embedding in a background sequence.</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="AbstractSubstringGenerator.generateSubstring"><a class="viewcode-back" href="../synthetic.html#synthetic.AbstractSubstringGenerator.generateSubstring">[docs]</a>    <span class="k">def</span> <span class="nf">generateSubstring</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">();</span></div>
<div class="viewcode-block" id="AbstractSubstringGenerator.getJsonableObject"><a class="viewcode-back" href="../synthetic.html#synthetic.AbstractSubstringGenerator.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">();</span></div></div>

<div class="viewcode-block" id="FixedSubstringGenerator"><a class="viewcode-back" href="../synthetic.html#synthetic.FixedSubstringGenerator">[docs]</a><span class="k">class</span> <span class="nc">FixedSubstringGenerator</span><span class="p">(</span><span class="n">AbstractSubstringGenerator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        When generateSubstring() is called, always returns the same string.</span>
<span class="sd">        The string also serves as its own description</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fixedSubstring</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fixedSubstring</span> <span class="o">=</span> <span class="n">fixedSubstring</span><span class="p">;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">FixedSubstringGenerator</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
<div class="viewcode-block" id="FixedSubstringGenerator.generateSubstring"><a class="viewcode-back" href="../synthetic.html#synthetic.FixedSubstringGenerator.generateSubstring">[docs]</a>    <span class="k">def</span> <span class="nf">generateSubstring</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fixedSubstring</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fixedSubstring</span><span class="p">;</span></div>
<div class="viewcode-block" id="FixedSubstringGenerator.getJsonableObject"><a class="viewcode-back" href="../synthetic.html#synthetic.FixedSubstringGenerator.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;fixedSubstring-&quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">fixedSubstring</span><span class="p">;</span> </div></div>

<div class="viewcode-block" id="TransformedSubstringGenerator"><a class="viewcode-back" href="../synthetic.html#synthetic.TransformedSubstringGenerator">[docs]</a><span class="k">class</span> <span class="nc">TransformedSubstringGenerator</span><span class="p">(</span><span class="n">AbstractSubstringGenerator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Takes a substringGenerator and a set of AbstractTransformation objects,</span>
<span class="sd">        applies the transformations to the generated substring</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">substringGenerator</span><span class="p">,</span> <span class="n">transformations</span><span class="p">,</span> <span class="n">transformationsDescription</span><span class="o">=</span><span class="s2">&quot;transformations&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">substringGenerator</span> <span class="o">=</span> <span class="n">substringGenerator</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transformations</span> <span class="o">=</span> <span class="n">transformations</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transformationsDescription</span> <span class="o">=</span> <span class="n">transformationsDescription</span><span class="p">;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">TransformedSubstringGenerator</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">);</span>
<div class="viewcode-block" id="TransformedSubstringGenerator.generateSubstring"><a class="viewcode-back" href="../synthetic.html#synthetic.TransformedSubstringGenerator.generateSubstring">[docs]</a>    <span class="k">def</span> <span class="nf">generateSubstring</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">substring</span><span class="p">,</span> <span class="n">substringDescription</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">substringGenerator</span><span class="o">.</span><span class="n">generateSubstring</span><span class="p">();</span>
        <span class="n">baseSubstringArr</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">substring</span><span class="p">];</span>
        <span class="k">for</span> <span class="n">transformation</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformations</span><span class="p">:</span>
            <span class="n">baseSubstringArr</span> <span class="o">=</span> <span class="n">transformation</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">baseSubstringArr</span><span class="p">);</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">baseSubstringArr</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformationsDescription</span><span class="o">+</span><span class="s2">&quot;-&quot;</span><span class="o">+</span><span class="n">substringDescription</span><span class="p">;</span></div>
<div class="viewcode-block" id="TransformedSubstringGenerator.getJsonableObject"><a class="viewcode-back" href="../synthetic.html#synthetic.TransformedSubstringGenerator.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="s2">&quot;class&quot;</span><span class="p">,</span> <span class="s2">&quot;TransformedSubstringGenerator&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;substringGenerator&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">substringGenerator</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">()),</span> <span class="p">(</span><span class="s2">&quot;transformations&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformations</span><span class="p">])]);</span> </div></div>

<div class="viewcode-block" id="AbstractTransformation"><a class="viewcode-back" href="../synthetic.html#synthetic.AbstractTransformation">[docs]</a><span class="k">class</span> <span class="nc">AbstractTransformation</span><span class="p">(</span><span class="n">DefaultNameMixin</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        takes an array of characters, applies some transformation, returns an</span>
<span class="sd">        array of characters (may be the same (mutated) one or a different one)</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="AbstractTransformation.transform"><a class="viewcode-back" href="../synthetic.html#synthetic.AbstractTransformation.transform">[docs]</a>    <span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stringArr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            stringArr is an array of characters.</span>
<span class="sd">            Returns an array of characters that has the transformation applied.</span>
<span class="sd">            May mutate stringArr</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">();</span></div>
<div class="viewcode-block" id="AbstractTransformation.getJsonableObject"><a class="viewcode-back" href="../synthetic.html#synthetic.AbstractTransformation.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">();</span></div></div>

<div class="viewcode-block" id="RevertToReference"><a class="viewcode-back" href="../synthetic.html#synthetic.RevertToReference">[docs]</a><span class="k">class</span> <span class="nc">RevertToReference</span><span class="p">(</span><span class="n">AbstractTransformation</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        for a series of mutations, reverts the supplied string to the reference</span>
<span class="sd">        (&quot;unmutated&quot;) string</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">setOfMutations</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            setOfMutations: instance of AbstractSetOfMutations</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setOfMutations</span> <span class="o">=</span> <span class="n">setOfMutations</span><span class="p">;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">RevertToReference</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
<div class="viewcode-block" id="RevertToReference.transform"><a class="viewcode-back" href="../synthetic.html#synthetic.RevertToReference.transform">[docs]</a>    <span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stringArr</span><span class="p">):</span> <span class="c1">#see parent docs</span>
        <span class="k">for</span> <span class="n">mutation</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">setOfMutations</span><span class="o">.</span><span class="n">getMutationsArr</span><span class="p">():</span>
            <span class="n">mutation</span><span class="o">.</span><span class="n">revert</span><span class="p">(</span><span class="n">stringArr</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">stringArr</span><span class="p">;</span></div>
<div class="viewcode-block" id="RevertToReference.getJsonableObject"><a class="viewcode-back" href="../synthetic.html#synthetic.RevertToReference.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="s2">&quot;class&quot;</span><span class="p">,</span> <span class="s2">&quot;RevertToReference&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;setOfMutations&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">setOfMutations</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">())]);</span> </div></div>

<div class="viewcode-block" id="AbstractApplySingleMutationFromSet"><a class="viewcode-back" href="../synthetic.html#synthetic.AbstractApplySingleMutationFromSet">[docs]</a><span class="k">class</span> <span class="nc">AbstractApplySingleMutationFromSet</span><span class="p">(</span><span class="n">AbstractTransformation</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Class for applying a single mutation from a set of mutations; used</span>
<span class="sd">        to transform substrings generated by another method</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">setOfMutations</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            setOfMutations: instance of AbstractSetOfMutations</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setOfMutations</span> <span class="o">=</span> <span class="n">setOfMutations</span><span class="p">;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">AbstractApplySingleMutationFromSet</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
<div class="viewcode-block" id="AbstractApplySingleMutationFromSet.transform"><a class="viewcode-back" href="../synthetic.html#synthetic.AbstractApplySingleMutationFromSet.transform">[docs]</a>    <span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stringArr</span><span class="p">):</span> <span class="c1">#see parent docs</span>
        <span class="n">selectedMutation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selectMutation</span><span class="p">();</span>
        <span class="n">selectedMutation</span><span class="o">.</span><span class="n">applyMutation</span><span class="p">(</span><span class="n">stringArr</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">stringArr</span><span class="p">;</span></div>
<div class="viewcode-block" id="AbstractApplySingleMutationFromSet.selectMutation"><a class="viewcode-back" href="../synthetic.html#synthetic.AbstractApplySingleMutationFromSet.selectMutation">[docs]</a>    <span class="k">def</span> <span class="nf">selectMutation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">();</span></div>
<div class="viewcode-block" id="AbstractApplySingleMutationFromSet.getClassName"><a class="viewcode-back" href="../synthetic.html#synthetic.AbstractApplySingleMutationFromSet.getClassName">[docs]</a>    <span class="k">def</span> <span class="nf">getClassName</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">();</span></div>
<div class="viewcode-block" id="AbstractApplySingleMutationFromSet.getJsonableObject"><a class="viewcode-back" href="../synthetic.html#synthetic.AbstractApplySingleMutationFromSet.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="s2">&quot;class&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">getClassName</span><span class="p">()),</span> <span class="p">(</span><span class="s2">&quot;selectedMutations&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">setOfMutations</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">())]);</span></div></div>

<div class="viewcode-block" id="ChooseMutationAtRandom"><a class="viewcode-back" href="../synthetic.html#synthetic.ChooseMutationAtRandom">[docs]</a><span class="k">class</span> <span class="nc">ChooseMutationAtRandom</span><span class="p">(</span><span class="n">AbstractApplySingleMutationFromSet</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Selects a mutation at random from self.setOfMutations to apply; see parent docs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="ChooseMutationAtRandom.selectMutation"><a class="viewcode-back" href="../synthetic.html#synthetic.ChooseMutationAtRandom.selectMutation">[docs]</a>    <span class="k">def</span> <span class="nf">selectMutation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">mutationsArr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setOfMutations</span><span class="o">.</span><span class="n">getMutationsArr</span><span class="p">();</span>
        <span class="k">return</span> <span class="n">mutationsArr</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">mutationsArr</span><span class="p">))];</span></div>
<div class="viewcode-block" id="ChooseMutationAtRandom.getClassName"><a class="viewcode-back" href="../synthetic.html#synthetic.ChooseMutationAtRandom.getClassName">[docs]</a>    <span class="k">def</span> <span class="nf">getClassName</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;ChooseMutationAtRandom&quot;</span><span class="p">;</span></div></div>

<div class="viewcode-block" id="AbstractSetOfMutations"><a class="viewcode-back" href="../synthetic.html#synthetic.AbstractSetOfMutations">[docs]</a><span class="k">class</span> <span class="nc">AbstractSetOfMutations</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Represents a collection of pwm.Mutation objects</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mutationsArr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            mutationsArr: array of pwm.Mutation objects</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutationsArr</span> <span class="o">=</span> <span class="n">mutationsArr</span><span class="p">;</span>
<div class="viewcode-block" id="AbstractSetOfMutations.getMutationsArr"><a class="viewcode-back" href="../synthetic.html#synthetic.AbstractSetOfMutations.getMutationsArr">[docs]</a>    <span class="k">def</span> <span class="nf">getMutationsArr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mutationsArr</span><span class="p">;</span></div>
<div class="viewcode-block" id="AbstractSetOfMutations.getJsonableObject"><a class="viewcode-back" href="../synthetic.html#synthetic.AbstractSetOfMutations.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">();</span></div></div>

<div class="viewcode-block" id="TopNMutationsFromPwmRelativeToBestHit"><a class="viewcode-back" href="../synthetic.html#synthetic.TopNMutationsFromPwmRelativeToBestHit">[docs]</a><span class="k">class</span> <span class="nc">TopNMutationsFromPwmRelativeToBestHit</span><span class="p">(</span><span class="n">AbstractSetOfMutations</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        See docs for parent; here, the collection of mutations are the</span>
<span class="sd">        top N strongest mutations for a PWM as compared to the best</span>
<span class="sd">        match for that pwm.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pwm</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">bestHitMode</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            pwm: instance of pwm.PWM</span>
<span class="sd">            N: the N in the top N strongest mutations</span>
<span class="sd">            bestHitMode: one of pwm.BEST_HIT_MODE; pwm.BEST_HIT_MODE.pwmProb defines the</span>
<span class="sd">                topN mutations relative to the probability matrix of the pwm, while</span>
<span class="sd">                pwm.BEST_HIT_MODE.logOdds defines the topN mutations relative to the log</span>
<span class="sd">                odds matrix computed using the background frequency specified in the</span>
<span class="sd">                pwm object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pwm</span> <span class="o">=</span> <span class="n">pwm</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">N</span> <span class="o">=</span> <span class="n">N</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bestHitMode</span> <span class="o">=</span> <span class="n">bestHitMode</span><span class="p">;</span>
        <span class="n">mutationsArr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pwm</span><span class="o">.</span><span class="n">computeSingleBpMutationEffects</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bestHitMode</span><span class="p">);</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">TopNMutationsFromPwmRelativeToBestHit</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">mutationsArr</span><span class="p">);</span> 
<div class="viewcode-block" id="TopNMutationsFromPwmRelativeToBestHit.getJsonableObject"><a class="viewcode-back" href="../synthetic.html#synthetic.TopNMutationsFromPwmRelativeToBestHit.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="s2">&quot;class&quot;</span><span class="p">,</span><span class="s2">&quot;TopNMutationsFromPwmRelativeToBestHit&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;pwm&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">pwm</span><span class="o">.</span><span class="n">name</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;bestHitMode&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bestHitMode</span><span class="p">)]);</span> </div></div>

<span class="c1">#is an AbstractSetOfMutations object</span>
<div class="viewcode-block" id="TopNMutationsFromPwmRelativeToBestHit_FromLoadedMotifs"><a class="viewcode-back" href="../synthetic.html#synthetic.TopNMutationsFromPwmRelativeToBestHit_FromLoadedMotifs">[docs]</a><span class="k">class</span> <span class="nc">TopNMutationsFromPwmRelativeToBestHit_FromLoadedMotifs</span><span class="p">(</span><span class="n">TopNMutationsFromPwmRelativeToBestHit</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Like parent, except extracts the pwm.PWM object from an AbstractLoadedMotifs object,</span>
<span class="sd">        saving you a few lines of code.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loadedMotifs</span><span class="p">,</span> <span class="n">pwmName</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">bestHitMode</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loadedMotifs</span> <span class="o">=</span> <span class="n">loadedMotifs</span><span class="p">;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">TopNMutationsFromPwmRelativeToBestHit_FromLoadedMotifs</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">loadedMotifs</span><span class="o">.</span><span class="n">getPwm</span><span class="p">(</span><span class="n">pwmName</span><span class="p">),</span> <span class="n">N</span><span class="p">,</span> <span class="n">bestHitMode</span><span class="p">);</span>
<div class="viewcode-block" id="TopNMutationsFromPwmRelativeToBestHit_FromLoadedMotifs.getJsonableObject"><a class="viewcode-back" href="../synthetic.html#synthetic.TopNMutationsFromPwmRelativeToBestHit_FromLoadedMotifs.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">TopNMutationsFromPwmRelativeToBestHit_FromLoadedMotifs</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">();</span>
        <span class="n">obj</span><span class="p">[</span><span class="s1">&#39;loadedMotifs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loadedMotifs</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">();</span>
        <span class="k">return</span> <span class="n">obj</span><span class="p">;</span></div></div>

<div class="viewcode-block" id="ReverseComplementWrapper"><a class="viewcode-back" href="../synthetic.html#synthetic.ReverseComplementWrapper">[docs]</a><span class="k">class</span> <span class="nc">ReverseComplementWrapper</span><span class="p">(</span><span class="n">AbstractSubstringGenerator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Wrapper around a AbstractSubstringGenerator that reverse complements it</span>
<span class="sd">        with the specified probability.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">substringGenerator</span><span class="p">,</span> <span class="n">reverseComplementProb</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            substringGenerator: instance of AbstractSubstringGenerator</span>
<span class="sd">            reverseComplementProb: probability of reverse complementing it.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reverseComplementProb</span><span class="o">=</span><span class="n">reverseComplementProb</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">substringGenerator</span><span class="o">=</span><span class="n">substringGenerator</span><span class="p">;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ReverseComplementWrapper</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
<div class="viewcode-block" id="ReverseComplementWrapper.generateSubstring"><a class="viewcode-back" href="../synthetic.html#synthetic.ReverseComplementWrapper.generateSubstring">[docs]</a>    <span class="k">def</span> <span class="nf">generateSubstring</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">seq</span><span class="p">,</span> <span class="n">seqDescription</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">substringGenerator</span><span class="o">.</span><span class="n">generateSubstring</span><span class="p">();</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">reverseComplementProb</span><span class="p">):</span> 
            <span class="n">seq</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">reverseComplement</span><span class="p">(</span><span class="n">seq</span><span class="p">);</span>
            <span class="n">seqDescription</span> <span class="o">=</span> <span class="s2">&quot;revComp-&quot;</span><span class="o">+</span><span class="n">seqDescription</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">seq</span><span class="p">,</span> <span class="n">seqDescription</span><span class="p">;</span></div>
<div class="viewcode-block" id="ReverseComplementWrapper.getJsonableObject"><a class="viewcode-back" href="../synthetic.html#synthetic.ReverseComplementWrapper.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="s2">&quot;class&quot;</span><span class="p">,</span> <span class="s2">&quot;ReverseComplementWrapper&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;reverseComplementProb&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">reverseComplementProb</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;substringGenerator&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">substringGenerator</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">())]);</span></div></div>

<div class="viewcode-block" id="PwmSampler"><a class="viewcode-back" href="../synthetic.html#synthetic.PwmSampler">[docs]</a><span class="k">class</span> <span class="nc">PwmSampler</span><span class="p">(</span><span class="n">AbstractSubstringGenerator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        samples from the pwm by calling self.pwm.sampleFromPwm</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pwm</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pwm</span> <span class="o">=</span> <span class="n">pwm</span><span class="p">;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">PwmSampler</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
<div class="viewcode-block" id="PwmSampler.generateSubstring"><a class="viewcode-back" href="../synthetic.html#synthetic.PwmSampler.generateSubstring">[docs]</a>    <span class="k">def</span> <span class="nf">generateSubstring</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pwm</span><span class="o">.</span><span class="n">sampleFromPwm</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">pwm</span><span class="o">.</span><span class="n">name</span><span class="p">;</span></div>
<div class="viewcode-block" id="PwmSampler.getJsonableObject"><a class="viewcode-back" href="../synthetic.html#synthetic.PwmSampler.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="s2">&quot;class&quot;</span><span class="p">,</span> <span class="s2">&quot;PwmSampler&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;motifName&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">pwm</span><span class="o">.</span><span class="n">name</span><span class="p">)]);</span> </div></div>

<div class="viewcode-block" id="PwmSamplerFromLoadedMotifs"><a class="viewcode-back" href="../synthetic.html#synthetic.PwmSamplerFromLoadedMotifs">[docs]</a><span class="k">class</span> <span class="nc">PwmSamplerFromLoadedMotifs</span><span class="p">(</span><span class="n">PwmSampler</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        convenience wrapper class for instantiating parent by pulling the pwm given the name</span>
<span class="sd">        from an AbstractLoadedMotifs object (it basically extracts the pwm for you)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loadedMotifs</span><span class="p">,</span> <span class="n">motifName</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loadedMotifs</span> <span class="o">=</span> <span class="n">loadedMotifs</span><span class="p">;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">PwmSamplerFromLoadedMotifs</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">loadedMotifs</span><span class="o">.</span><span class="n">getPwm</span><span class="p">(</span><span class="n">motifName</span><span class="p">),</span> <span class="n">name</span><span class="p">);</span>
<div class="viewcode-block" id="PwmSamplerFromLoadedMotifs.getJsonableObject"><a class="viewcode-back" href="../synthetic.html#synthetic.PwmSamplerFromLoadedMotifs.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">PwmSamplerFromLoadedMotifs</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">();</span>
        <span class="n">obj</span><span class="p">[</span><span class="s1">&#39;loadedMotifs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loadedMotifs</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">();</span>
        <span class="k">return</span> <span class="n">obj</span><span class="p">;</span></div></div>

<div class="viewcode-block" id="BestHitPwm"><a class="viewcode-back" href="../synthetic.html#synthetic.BestHitPwm">[docs]</a><span class="k">class</span> <span class="nc">BestHitPwm</span><span class="p">(</span><span class="n">AbstractSubstringGenerator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        always returns the best possible match to the pwm in question when called</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pwm</span><span class="p">,</span> <span class="n">bestHitMode</span><span class="o">=</span><span class="n">pwm</span><span class="o">.</span><span class="n">BEST_HIT_MODE</span><span class="o">.</span><span class="n">pwmProb</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pwm</span> <span class="o">=</span> <span class="n">pwm</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bestHitMode</span> <span class="o">=</span> <span class="n">bestHitMode</span><span class="p">;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">BestHitPwm</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
<div class="viewcode-block" id="BestHitPwm.generateSubstring"><a class="viewcode-back" href="../synthetic.html#synthetic.BestHitPwm.generateSubstring">[docs]</a>    <span class="k">def</span> <span class="nf">generateSubstring</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pwm</span><span class="o">.</span><span class="n">getBestHit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bestHitMode</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">pwm</span><span class="o">.</span><span class="n">name</span><span class="p">;</span> </div>
<div class="viewcode-block" id="BestHitPwm.getJsonableObject"><a class="viewcode-back" href="../synthetic.html#synthetic.BestHitPwm.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="s2">&quot;class&quot;</span><span class="p">,</span> <span class="s2">&quot;BestHitPwm&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;pwm&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">pwm</span><span class="o">.</span><span class="n">name</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;bestHitMode&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bestHitMode</span><span class="p">)]);</span></div></div>

<div class="viewcode-block" id="BestHitPwmFromLoadedMotifs"><a class="viewcode-back" href="../synthetic.html#synthetic.BestHitPwmFromLoadedMotifs">[docs]</a><span class="k">class</span> <span class="nc">BestHitPwmFromLoadedMotifs</span><span class="p">(</span><span class="n">BestHitPwm</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        convenience wrapper class for instantiating parent by pulling the pwm given the name</span>
<span class="sd">        from an AbstractLoadedMotifs object (it basically extracts the pwm for you)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loadedMotifs</span><span class="p">,</span> <span class="n">motifName</span><span class="p">,</span> <span class="n">bestHitMode</span><span class="o">=</span><span class="n">pwm</span><span class="o">.</span><span class="n">BEST_HIT_MODE</span><span class="o">.</span><span class="n">pwmProb</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loadedMotifs</span> <span class="o">=</span> <span class="n">loadedMotifs</span><span class="p">;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">BestHitPwmFromLoadedMotifs</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">loadedMotifs</span><span class="o">.</span><span class="n">getPwm</span><span class="p">(</span><span class="n">motifName</span><span class="p">),</span> <span class="n">bestHitMode</span><span class="p">,</span> <span class="n">name</span><span class="p">);</span>
<div class="viewcode-block" id="BestHitPwmFromLoadedMotifs.getJsonableObject"><a class="viewcode-back" href="../synthetic.html#synthetic.BestHitPwmFromLoadedMotifs.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">BestHitPwmFromLoadedMotifs</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">();</span>
        <span class="n">obj</span><span class="p">[</span><span class="s1">&#39;loadedMotifs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loadedMotifs</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">();</span>
        <span class="k">return</span> <span class="n">obj</span><span class="p">;</span></div></div>

<div class="viewcode-block" id="AbstractLoadedMotifs"><a class="viewcode-back" href="../synthetic.html#synthetic.AbstractLoadedMotifs">[docs]</a><span class="k">class</span> <span class="nc">AbstractLoadedMotifs</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A class that contains instances of pwm.PWM loaded from a file.</span>
<span class="sd">        The pwms can be accessed by name.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fileName</span><span class="p">,</span> <span class="n">pseudocountProb</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="n">util</span><span class="o">.</span><span class="n">DEFAULT_BACKGROUND_FREQ</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            fileName: the path to the file to laod</span>
<span class="sd">            pseudocountProb: if some of the pwms have 0 probability for</span>
<span class="sd">            some of the positions, will add the specified pseudocountProb</span>
<span class="sd">            to the rows of the pwm and renormalise.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fileName</span> <span class="o">=</span> <span class="n">fileName</span><span class="p">;</span>
        <span class="n">fileHandle</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">getFileHandle</span><span class="p">(</span><span class="n">fileName</span><span class="p">);</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pseudocountProb</span> <span class="o">=</span> <span class="n">pseudocountProb</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">background</span> <span class="o">=</span> <span class="n">background</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recordedPwms</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">();</span>
        <span class="n">action</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getReadPwmAction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">recordedPwms</span><span class="p">);</span>
        <span class="n">fp</span><span class="o">.</span><span class="n">performActionOnEachLineOfFile</span><span class="p">(</span>
            <span class="n">fileHandle</span> <span class="o">=</span> <span class="n">fileHandle</span>
            <span class="p">,</span><span class="n">transformation</span><span class="o">=</span><span class="n">fp</span><span class="o">.</span><span class="n">trimNewline</span>
            <span class="p">,</span><span class="n">action</span><span class="o">=</span><span class="n">action</span>
        <span class="p">);</span>
        <span class="k">for</span> <span class="n">pwm</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">recordedPwms</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">pwm</span><span class="o">.</span><span class="n">finalise</span><span class="p">(</span><span class="n">pseudocountProb</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pseudocountProb</span><span class="p">);</span>
<div class="viewcode-block" id="AbstractLoadedMotifs.getPwm"><a class="viewcode-back" href="../synthetic.html#synthetic.AbstractLoadedMotifs.getPwm">[docs]</a>    <span class="k">def</span> <span class="nf">getPwm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            returns the pwm.PWM instance with the specified name.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">recordedPwms</span><span class="p">[</span><span class="n">name</span><span class="p">];</span></div>
<div class="viewcode-block" id="AbstractLoadedMotifs.getReadPwmAction"><a class="viewcode-back" href="../synthetic.html#synthetic.AbstractLoadedMotifs.getReadPwmAction">[docs]</a>    <span class="k">def</span> <span class="nf">getReadPwmAction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">recordedPwms</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            This is the action that is to be performed on each line of the</span>
<span class="sd">            file when it is read in. recordedPwms is an OrderedDict that</span>
<span class="sd">            stores instances of pwm.PWM</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">();</span></div>
<div class="viewcode-block" id="AbstractLoadedMotifs.getJsonableObject"><a class="viewcode-back" href="../synthetic.html#synthetic.AbstractLoadedMotifs.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="s2">&quot;fileName&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileName</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;pseudocountProb&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">pseudocountProb</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;background&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">background</span><span class="p">)]);</span></div></div>

<div class="viewcode-block" id="LoadedEncodeMotifs"><a class="viewcode-back" href="../synthetic.html#synthetic.LoadedEncodeMotifs">[docs]</a><span class="k">class</span> <span class="nc">LoadedEncodeMotifs</span><span class="p">(</span><span class="n">AbstractLoadedMotifs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This class is specifically for reading files in the encode motif</span>
<span class="sd">        format - specifically the motifs.txt file that contains Pouya&#39;s motifs</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="LoadedEncodeMotifs.getReadPwmAction"><a class="viewcode-back" href="../synthetic.html#synthetic.LoadedEncodeMotifs.getReadPwmAction">[docs]</a>    <span class="k">def</span> <span class="nf">getReadPwmAction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">recordedPwms</span><span class="p">):</span>
        <span class="n">currentPwm</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">VariableWrapper</span><span class="p">(</span><span class="kc">None</span><span class="p">);</span>
        <span class="k">def</span> <span class="nf">action</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">lineNumber</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">inp</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;&gt;&quot;</span><span class="p">)):</span>
                <span class="n">inp</span> <span class="o">=</span> <span class="n">inp</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s2">&quot;&gt;&quot;</span><span class="p">);</span>
                <span class="n">inpArr</span> <span class="o">=</span> <span class="n">inp</span><span class="o">.</span><span class="n">split</span><span class="p">();</span>
                <span class="n">motifName</span> <span class="o">=</span> <span class="n">inpArr</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
                <span class="n">currentPwm</span><span class="o">.</span><span class="n">var</span> <span class="o">=</span> <span class="n">pwm</span><span class="o">.</span><span class="n">PWM</span><span class="p">(</span><span class="n">motifName</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">background</span><span class="p">);</span>
                <span class="n">recordedPwms</span><span class="p">[</span><span class="n">currentPwm</span><span class="o">.</span><span class="n">var</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">currentPwm</span><span class="o">.</span><span class="n">var</span><span class="p">;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1">#assume that it&#39;s a line of the pwm</span>
                <span class="k">assert</span> <span class="n">currentPwm</span><span class="o">.</span><span class="n">var</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">;</span>
                <span class="n">inpArr</span> <span class="o">=</span> <span class="n">inp</span><span class="o">.</span><span class="n">split</span><span class="p">();</span>
                <span class="n">summaryLetter</span> <span class="o">=</span> <span class="n">inpArr</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
                <span class="n">currentPwm</span><span class="o">.</span><span class="n">var</span><span class="o">.</span><span class="n">addRow</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">inpArr</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]);</span>
        <span class="k">return</span> <span class="n">action</span><span class="p">;</span></div></div>

<div class="viewcode-block" id="AbstractBackgroundGenerator"><a class="viewcode-back" href="../synthetic.html#synthetic.AbstractBackgroundGenerator">[docs]</a><span class="k">class</span> <span class="nc">AbstractBackgroundGenerator</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the sequence that the embeddings are subsequently inserted into.</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="AbstractBackgroundGenerator.generateBackground"><a class="viewcode-back" href="../synthetic.html#synthetic.AbstractBackgroundGenerator.generateBackground">[docs]</a>    <span class="k">def</span> <span class="nf">generateBackground</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">();</span></div>
<div class="viewcode-block" id="AbstractBackgroundGenerator.getJsonableObject"><a class="viewcode-back" href="../synthetic.html#synthetic.AbstractBackgroundGenerator.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">();</span></div></div>

<div class="viewcode-block" id="RepeatedSubstringBackgroundGenerator"><a class="viewcode-back" href="../synthetic.html#synthetic.RepeatedSubstringBackgroundGenerator">[docs]</a><span class="k">class</span> <span class="nc">RepeatedSubstringBackgroundGenerator</span><span class="p">(</span><span class="n">AbstractBackgroundGenerator</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">substringGenerator</span><span class="p">,</span> <span class="n">repetitions</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            substringGenerator: instance of AbstractSubstringGenerator</span>
<span class="sd">            repetitions: instance of AbstractQuantityGenerator. If pass an int, </span>
<span class="sd">                will create a FixedQuantityGenerator from the int.</span>
<span class="sd">            returns the concatenation of all the calls to the substringGenerator</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">substringGenerator</span> <span class="o">=</span> <span class="n">substringGenerator</span><span class="p">;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">repetitions</span><span class="p">,</span><span class="nb">int</span><span class="p">):</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">repetitions</span> <span class="o">=</span> <span class="n">FixedQuantityGenerator</span><span class="p">(</span><span class="n">repetitions</span><span class="p">);</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">repetitions</span><span class="p">,</span> <span class="n">AbstractQuantityGenerator</span><span class="p">);</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">repetitions</span> <span class="o">=</span> <span class="n">repetitions</span><span class="p">;</span>
<div class="viewcode-block" id="RepeatedSubstringBackgroundGenerator.generateBackground"><a class="viewcode-back" href="../synthetic.html#synthetic.RepeatedSubstringBackgroundGenerator.generateBackground">[docs]</a>    <span class="k">def</span> <span class="nf">generateBackground</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">toReturn</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">repetitions</span><span class="o">.</span><span class="n">generateQuantity</span><span class="p">()):</span>
            <span class="n">toReturn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">substringGenerator</span><span class="o">.</span><span class="n">generateSubstring</span><span class="p">()[</span><span class="mi">0</span><span class="p">]);</span> <span class="c1">#first pos is substring, second pos is the name</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">toReturn</span><span class="p">);</span></div>
<div class="viewcode-block" id="RepeatedSubstringBackgroundGenerator.getJsonableObject"><a class="viewcode-back" href="../synthetic.html#synthetic.RepeatedSubstringBackgroundGenerator.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="s2">&quot;class&quot;</span><span class="p">,</span> <span class="s2">&quot;RepeatedSubstringBackgroundGenerator&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;substringGenerator&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">substringGenerator</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">()),</span> <span class="p">(</span><span class="s2">&quot;repetitions&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">repetitions</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">())]);</span></div></div>

<div class="viewcode-block" id="SampleFromDiscreteDistributionSubstringGenerator"><a class="viewcode-back" href="../synthetic.html#synthetic.SampleFromDiscreteDistributionSubstringGenerator">[docs]</a><span class="k">class</span> <span class="nc">SampleFromDiscreteDistributionSubstringGenerator</span><span class="p">(</span><span class="n">AbstractSubstringGenerator</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">discreteDistribution</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            discreteDistribution: instance of util.DiscreteDistribution</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">discreteDistribution</span><span class="o">=</span><span class="n">discreteDistribution</span><span class="p">;</span>
<div class="viewcode-block" id="SampleFromDiscreteDistributionSubstringGenerator.generateSubstring"><a class="viewcode-back" href="../synthetic.html#synthetic.SampleFromDiscreteDistributionSubstringGenerator.generateSubstring">[docs]</a>    <span class="k">def</span> <span class="nf">generateSubstring</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">util</span><span class="o">.</span><span class="n">sampleFromDiscreteDistribution</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">discreteDistribution</span><span class="p">);</span> </div>
<div class="viewcode-block" id="SampleFromDiscreteDistributionSubstringGenerator.getJsonableObject"><a class="viewcode-back" href="../synthetic.html#synthetic.SampleFromDiscreteDistributionSubstringGenerator.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="s2">&quot;class&quot;</span><span class="p">,</span> <span class="s2">&quot;SampleFromDiscreteDistributionSubstringGenerator&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;discreteDistribution&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">discreteDistribution</span><span class="o">.</span><span class="n">valToFreq</span><span class="p">)]);</span></div></div>
        

<div class="viewcode-block" id="ZeroOrderBackgroundGenerator"><a class="viewcode-back" href="../synthetic.html#synthetic.ZeroOrderBackgroundGenerator">[docs]</a><span class="k">class</span> <span class="nc">ZeroOrderBackgroundGenerator</span><span class="p">(</span><span class="n">RepeatedSubstringBackgroundGenerator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        returns a sequence with 40% GC content. Each base is sampled independently.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seqLength</span><span class="p">,</span> <span class="n">discreteDistribution</span><span class="o">=</span><span class="n">util</span><span class="o">.</span><span class="n">DEFAULT_BASE_DISCRETE_DISTRIBUTION</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            seqLength: the length of the sequence to return. Can also be an instance of AbstractQuantityGenerator</span>
<span class="sd">            discreteDistribution: instance of util.DiscreteDistribution</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ZeroOrderBackgroundGenerator</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">SampleFromDiscreteDistributionSubstringGenerator</span><span class="p">(</span><span class="n">discreteDistribution</span><span class="p">),</span> <span class="n">seqLength</span><span class="p">);</span></div>

<span class="c1">###</span>
<span class="c1">#Older API below...this was just set up to generate the background sequence</span>
<span class="c1">###</span>

<div class="viewcode-block" id="getGenerationOption"><a class="viewcode-back" href="../synthetic.html#synthetic.getGenerationOption">[docs]</a><span class="k">def</span> <span class="nf">getGenerationOption</span><span class="p">(</span><span class="n">string</span><span class="p">):</span> <span class="c1">#for yaml serialisation</span>
    <span class="k">return</span> <span class="n">util</span><span class="o">.</span><span class="n">getFromEnum</span><span class="p">(</span><span class="n">GENERATION_OPTION</span><span class="p">,</span> <span class="s2">&quot;GENERATION_OPTION&quot;</span><span class="p">,</span> <span class="n">string</span><span class="p">);</span></div>
<span class="n">GENERATION_OPTION</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">enum</span><span class="p">(</span><span class="n">zeroOrderMarkov</span><span class="o">=</span><span class="s2">&quot;zrOrdMrkv&quot;</span><span class="p">);</span>

<div class="viewcode-block" id="getFileNamePieceFromOptions"><a class="viewcode-back" href="../synthetic.html#synthetic.getFileNamePieceFromOptions">[docs]</a><span class="k">def</span> <span class="nf">getFileNamePieceFromOptions</span><span class="p">(</span><span class="n">options</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">options</span><span class="o">.</span><span class="n">generationOption</span><span class="o">+</span><span class="s2">&quot;_seqLen&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">seqLength</span><span class="p">);</span> </div>

<div class="viewcode-block" id="generateString_zeroOrderMarkov"><a class="viewcode-back" href="../synthetic.html#synthetic.generateString_zeroOrderMarkov">[docs]</a><span class="k">def</span> <span class="nf">generateString_zeroOrderMarkov</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">discreteDistribution</span><span class="o">=</span><span class="n">util</span><span class="o">.</span><span class="n">DEFAULT_BASE_DISCRETE_DISTRIBUTION</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        discreteDistribution: instance of util.DiscreteDistribution</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sampledArr</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">sampleNinstancesFromDiscreteDistribution</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">discreteDistribution</span><span class="p">);</span>
    <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sampledArr</span><span class="p">);</span></div>

<div class="viewcode-block" id="generateString"><a class="viewcode-back" href="../synthetic.html#synthetic.generateString">[docs]</a><span class="k">def</span> <span class="nf">generateString</span><span class="p">(</span><span class="n">options</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">options</span><span class="o">.</span><span class="n">generationOption</span><span class="o">==</span><span class="n">GENERATION_OPTION</span><span class="o">.</span><span class="n">zeroOrderMarkov</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">generateString_zeroOrderMarkov</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="n">options</span><span class="o">.</span><span class="n">seqLength</span><span class="p">);</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Unsupported generation option: &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">generationOption</span><span class="p">));</span></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016, Avanti Shrikumar, Johnny Israeli.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.4.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.9</a>
      
    </div>

    

    
  </body>
</html>